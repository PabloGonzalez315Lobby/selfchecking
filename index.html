<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hotel Self Check-in | Secure Guest Registration</title>
    <meta name="description" content="Complete your hotel check-in online with our secure self-service platform. Upload documents, register companions, and start your stay seamlessly.">
    <meta name="author" content="Hotel Self Check-in System">
    
    <meta property="og:title" content="Hotel Self Check-in | Secure Guest Registration">
    <meta property="og:description" content="Complete your hotel check-in online with our secure self-service platform. Upload documents, register companions, and start your stay seamlessly.">
    
    <meta name="twitter:card" content="summary_large_image">

    
    
    <style>
        :root {
            /* Design System Colors */
            --background: 220 13% 97%;
            --foreground: 220 9% 9%;
            --card: 220 13% 96%;
            --card-foreground: 220 9% 9%;
            --popover: 220 13% 97%;
            --popover-foreground: 220 9% 9%;
            --primary: 212 100% 45%;
            --primary-foreground: 0 0% 100%;
            --secondary: 220 9% 93%;
            --secondary-foreground: 220 9% 9%;
            --muted: 220 9% 93%;
            --muted-foreground: 220 9% 46%;
            --accent: 220 9% 93%;
            --accent-foreground: 220 9% 9%;
            --destructive: 0 84% 60%;
            --destructive-foreground: 0 0% 100%;
            --border: 220 9% 88%;
            --input: 220 9% 88%;
            --ring: 212 100% 45%;
            --radius: 0.5rem;
            
            /* Hotel Design Tokens */
            --hotel-gradient-primary: linear-gradient(135deg, hsl(var(--primary)), hsl(212 100% 55%));
            --hotel-shadow-elegant: 0 10px 30px -10px hsl(var(--primary) / 0.15);
            --hotel-shadow-glow: 0 0 40px hsl(212 100% 55% / 0.2);
            --transition-smooth: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .dark {
            --background: 220 13% 9%;
            --foreground: 220 9% 97%;
            --card: 220 13% 10%;
            --card-foreground: 220 9% 97%;
            --popover: 220 13% 9%;
            --popover-foreground: 220 9% 97%;
            --primary: 212 100% 55%;
            --primary-foreground: 0 0% 100%;
            --secondary: 220 9% 15%;
            --secondary-foreground: 220 9% 97%;
            --muted: 220 9% 15%;
            --muted-foreground: 220 9% 63%;
            --accent: 220 9% 15%;
            --accent-foreground: 220 9% 97%;
            --destructive: 0 84% 60%;
            --destructive-foreground: 0 0% 100%;
            --border: 220 9% 20%;
            --input: 220 9% 20%;
            --ring: 212 100% 55%;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: hsl(var(--background));
            color: hsl(var(--foreground));
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1rem;
        }

        .hotel-card {
            background: hsl(var(--card));
            border: 1px solid hsl(var(--border));
            border-radius: var(--radius);
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: var(--hotel-shadow-elegant);
            transition: var(--transition-smooth);
        }

        .hotel-card:hover {
            box-shadow: var(--hotel-shadow-glow);
        }

        .hotel-button-primary {
            background: var(--hotel-gradient-primary);
            color: hsl(var(--primary-foreground));
            border: none;
            border-radius: var(--radius);
            padding: 0.75rem 1.5rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition-smooth);
            font-size: 1rem;
        }

        .hotel-button-primary:hover {
            transform: translateY(-2px);
            box-shadow: var(--hotel-shadow-glow);
        }

        .hotel-button-primary:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .hotel-input {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 1px solid hsl(var(--border));
            border-radius: var(--radius);
            background: hsl(var(--background));
            color: hsl(var(--foreground));
            font-size: 1rem;
            transition: var(--transition-smooth);
        }

        .hotel-input:focus {
            outline: none;
            border-color: hsl(var(--ring));
            box-shadow: 0 0 0 2px hsl(var(--ring) / 0.2);
        }

        .hotel-select {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 1px solid hsl(var(--border));
            border-radius: var(--radius);
            background: hsl(var(--background));
            color: hsl(var(--foreground));
            font-size: 1rem;
            transition: var(--transition-smooth);
        }

        .hotel-select:focus {
            outline: none;
            border-color: hsl(var(--ring));
            box-shadow: 0 0 0 2px hsl(var(--ring) / 0.2);
        }

        .hotel-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: hsl(var(--foreground));
        }

        .grid {
            display: grid;
            gap: 1rem;
        }

        .grid-cols-1 { grid-template-columns: repeat(1, minmax(0, 1fr)); }
        .grid-cols-2 { grid-template-columns: repeat(2, minmax(0, 1fr)); }
        .grid-cols-3 { grid-template-columns: repeat(3, minmax(0, 1fr)); }

        @media (max-width: 768px) {
            .grid-cols-2, .grid-cols-3 {
                grid-template-columns: 1fr;
            }
        }

        .flex {
            display: flex;
        }

        .items-center {
            align-items: center;
        }

        .justify-center {
            justify-content: center;
        }

        .justify-between {
            justify-content: space-between;
        }

        .justify-end {
            justify-content: flex-end;
        }

        .space-x-2 > * + * {
            margin-left: 0.5rem;
        }

        .space-y-4 > * + * {
            margin-top: 1rem;
        }

        .space-y-6 > * + * {
            margin-top: 1.5rem;
        }

        .text-center {
            text-align: center;
        }

        .text-3xl {
            font-size: 1.875rem;
            line-height: 2.25rem;
        }

        .text-xl {
            font-size: 1.25rem;
            line-height: 1.75rem;
        }

        .text-lg {
            font-size: 1.125rem;
            line-height: 1.75rem;
        }

        .text-sm {
            font-size: 0.875rem;
            line-height: 1.25rem;
        }

        .font-bold {
            font-weight: 700;
        }

        .font-semibold {
            font-weight: 600;
        }

        .font-medium {
            font-weight: 500;
        }

        .mb-2 { margin-bottom: 0.5rem; }
        .mb-4 { margin-bottom: 1rem; }
        .mb-6 { margin-bottom: 1.5rem; }
        .mb-8 { margin-bottom: 2rem; }
        .mt-4 { margin-top: 1rem; }
        .mt-6 { margin-top: 1.5rem; }
        .py-8 { padding-top: 2rem; padding-bottom: 2rem; }
        .px-4 { padding-left: 1rem; padding-right: 1rem; }
        .px-3 { padding-left: 0.75rem; padding-right: 0.75rem; }
        .py-1 { padding-top: 0.25rem; padding-bottom: 0.25rem; }
        .px-8 { padding-left: 2rem; padding-right: 2rem; }
        .py-4 { padding-top: 1rem; padding-bottom: 1rem; }

        .min-h-screen {
            min-height: 100vh;
        }

        .max-w-2xl {
            max-width: 42rem;
        }

        .max-w-4xl {
            max-width: 56rem;
        }

        .mx-auto {
            margin-left: auto;
            margin-right: auto;
        }

        .hidden {
            display: none;
        }

        .rounded-md {
            border-radius: 0.375rem;
        }

        .w-5 {
            width: 1.25rem;
        }

        .h-5 {
            height: 1.25rem;
        }

        .w-full {
            width: 100%;
        }

        .min-w-200 {
            min-width: 200px;
        }

        .text-muted-foreground {
            color: hsl(var(--muted-foreground));
        }

        .text-primary {
            color: hsl(var(--primary));
        }

        .bg-primary {
            background-color: hsl(var(--primary));
        }

        .text-primary-foreground {
            color: hsl(var(--primary-foreground));
        }

        .bg-secondary {
            background-color: hsl(var(--secondary));
        }

        .text-secondary-foreground {
            color: hsl(var(--secondary-foreground));
        }

        .language-btn {
            padding: 0.25rem 0.75rem;
            border-radius: 0.375rem;
            font-size: 0.875rem;
            font-weight: 500;
            transition: var(--transition-smooth);
            border: none;
            cursor: pointer;
        }

        .language-btn.active {
            background-color: hsl(var(--primary));
            color: hsl(var(--primary-foreground));
        }

        .language-btn:not(.active) {
            background-color: hsl(var(--secondary));
            color: hsl(var(--secondary-foreground));
        }

        .language-btn:not(.active):hover {
            background-color: hsl(var(--secondary) / 0.8);
        }

        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }

        .slide-up {
            animation: slideUp 0.5s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideUp {
            from { 
                opacity: 0; 
                transform: translateY(20px); 
            }
            to { 
                opacity: 1; 
                transform: translateY(0); 
            }
        }

        .file-upload-zone {
            border: 2px dashed hsl(var(--border));
            border-radius: var(--radius);
            padding: 2rem;
            text-align: center;
            transition: var(--transition-smooth);
            cursor: pointer;
        }

        .file-upload-zone:hover {
            border-color: hsl(var(--primary));
            background-color: hsl(var(--primary) / 0.05);
        }

        .file-upload-zone.drag-over {
            border-color: hsl(var(--primary));
            background-color: hsl(var(--primary) / 0.1);
        }

        .file-list {
            margin-top: 1rem;
        }

        .file-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.5rem;
            background: hsl(var(--muted));
            border-radius: var(--radius);
            margin-bottom: 0.5rem;
        }

        .captcha-display {
            background: hsl(var(--muted));
            border: 1px solid hsl(var(--border));
            border-radius: var(--radius);
            padding: 1rem;
            font-family: 'Courier New', monospace;
            font-size: 1.5rem;
            letter-spacing: 0.25rem;
            text-align: center;
            font-weight: bold;
            color: hsl(var(--primary));
            user-select: none;
        }

        .toast {
            position: fixed;
            top: 2rem;
            right: 2rem;
            background: hsl(var(--card));
            border: 1px solid hsl(var(--border));
            border-radius: var(--radius);
            padding: 1rem;
            box-shadow: var(--hotel-shadow-elegant);
            z-index: 1000;
            transition: var(--transition-smooth);
        }

        .toast.success {
            border-color: hsl(120 100% 25%);
        }

        .toast.error {
            border-color: hsl(var(--destructive));
        }

        .companion-section {
            border: 1px solid hsl(var(--border));
            border-radius: var(--radius);
            padding: 1.5rem;
            margin-bottom: 1rem;
            background: hsl(var(--card));
        }

        .remove-companion-btn {
            background: hsl(var(--destructive));
            color: hsl(var(--destructive-foreground));
            border: none;
            border-radius: var(--radius);
            padding: 0.5rem 1rem;
            cursor: pointer;
            font-size: 0.875rem;
            transition: var(--transition-smooth);
        }

        .remove-companion-btn:hover {
            opacity: 0.9;
        }

        .icon {
            width: 1.25rem;
            height: 1.25rem;
            display: inline-block;
            vertical-align: middle;
            margin-right: 0.5rem;
        }
    </style>
</head>

<body>
    <div id="app">
        <!-- Content will be injected by JavaScript -->
    </div>

    <script>
        // Translation system
        const translations = {
            ES: {
                hotelCheckin: 'Check-in de Hotel',
                searchReservation: 'Buscar tu reserva para continuar',
                checkinForm: 'Formulario de Check-in',
                welcome: 'Bienvenido',
                mainGuestData: 'Datos del Huésped Principal',
                locationData: 'Datos de Ubicación',
                additionalData: 'Datos Adicionales',
                uploadDocuments: 'Cargar Documentos',
                security: 'Verificación de Seguridad',
                
                // Form fields
                reservationNumber: 'Número de Reserva',
                searchReservationBtn: 'Buscar Reserva',
                idNumber: 'Número de Identificación',
                phone: 'Teléfono',
                email: 'Correo Electrónico',
                birthDate: 'Fecha de Nacimiento',
                comments: 'Comentarios',
                
                // Location fields
                country: 'País',
                state: 'Estado/Provincia',
                city: 'Ciudad',
                selectCountry: 'Selecciona un país',
                selectState: 'Selecciona un estado',
                selectCity: 'Selecciona una ciudad',
                loadingCountries: 'Cargando países...',
                loadingStates: 'Cargando estados...',
                loadingCities: 'Cargando ciudades...',
                
                // Colombia fields
                residenceAddress: 'Dirección de Residencia',
                nationality: 'Nacionalidad',
                origin: 'Procedencia',
                destination: 'Destino',
                arrivalDateTime: 'Fecha y Hora de Llegada',
                residenceCity: 'Ciudad de Residencia',
                travelReason: 'Motivo de Viaje',
                
                // Travel reasons
                tourism: 'Turismo',
                business: 'Negocios',
                study: 'Estudios',
                health: 'Salud',
                transit: 'Tránsito',
                family: 'Familia',
                work: 'Trabajo',
                other: 'Otro',
                religion: 'Religión',
                shopping: 'Compras',
                
                // Companions
                companions: 'Acompañantes',
                numGuests: 'Número de Huéspedes',
                addCompanion: 'Agregar Acompañante',
                removeCompanion: 'Eliminar Acompañante',
                companionData: 'Datos del Acompañante',
                name: 'Nombre',
                surname: 'Apellido',
                
                // File upload
                dragDropFiles: 'Arrastra y suelta archivos aquí o haz clic para seleccionar',
                supportedFormats: 'Formatos soportados: JPG, PNG, PDF (máx. 3MB)',
                uploadedFiles: 'Archivos cargados',
                removeFile: 'Eliminar archivo',
                fileTooLarge: 'El archivo es demasiado grande (máx. 3MB)',
                invalidFileType: 'Tipo de archivo no válido',
                
                // CAPTCHA
                captchaCode: 'Código de Verificación',
                enterCaptcha: 'Ingresa el código mostrado',
                regenerateCaptcha: 'Generar nuevo código',
                
                // Messages
                error: 'Error',
                success: 'Éxito',
                fillRequiredFields: 'Por favor completa todos los campos requeridos',
                fillLocationFields: 'Por favor completa todos los campos de ubicación',
                fillColombiaFields: 'Por favor completa todos los campos adicionales',
                invalidCaptcha: 'Código de verificación incorrecto',
                checkinSuccess: 'Check-in realizado exitosamente',
                submitError: 'Error al enviar el formulario',
                reservationNotFound: 'Reserva no encontrada',
                submitting: 'Enviando...',
                submitCheckin: 'Completar Check-in',
                searching: 'Buscando...',
                
                // Placeholders
                enterReservationNumber: 'Ingresa tu número de reserva',
                enterIdNumber: 'Ingresa tu número de identificación',
                enterPhone: 'Ingresa tu teléfono',
                enterEmail: 'Ingresa tu correo electrónico',
                enterComments: 'Comentarios adicionales (opcional)',
                enterAddress: 'Ingresa tu dirección de residencia',
                enterNationality: 'Ingresa tu nacionalidad',
                enterResidenceCity: 'Ingresa tu ciudad de residencia',
                
                // Additional
                noCompanions: 'No hay acompañantes agregados',
                selectReason: 'Selecciona un motivo'
            },
            
            EN: {
                hotelCheckin: 'Hotel Check-in',
                searchReservation: 'Search your reservation to continue',
                checkinForm: 'Check-in Form',
                welcome: 'Welcome',
                mainGuestData: 'Main Guest Data',
                locationData: 'Location Data',
                additionalData: 'Additional Data',
                uploadDocuments: 'Upload Documents',
                security: 'Security Verification',
                
                // Form fields
                reservationNumber: 'Reservation Number',
                searchReservationBtn: 'Search Reservation',
                idNumber: 'ID Number',
                phone: 'Phone',
                email: 'Email',
                birthDate: 'Birth Date',
                comments: 'Comments',
                
                // Location fields
                country: 'Country',
                state: 'State/Province',
                city: 'City',
                selectCountry: 'Select a country',
                selectState: 'Select a state',
                selectCity: 'Select a city',
                loadingCountries: 'Loading countries...',
                loadingStates: 'Loading states...',
                loadingCities: 'Loading cities...',
                
                // Colombia fields
                residenceAddress: 'Residence Address',
                nationality: 'Nationality',
                origin: 'Origin',
                destination: 'Destination',
                arrivalDateTime: 'Arrival Date and Time',
                residenceCity: 'Residence City',
                travelReason: 'Travel Reason',
                
                // Travel reasons
                tourism: 'Tourism',
                business: 'Business',
                study: 'Study',
                health: 'Health',
                transit: 'Transit',
                family: 'Family',
                work: 'Work',
                other: 'Other',
                religion: 'Religion',
                shopping: 'Shopping',
                
                // Companions
                companions: 'Companions',
                numGuests: 'Number of Guests',
                addCompanion: 'Add Companion',
                removeCompanion: 'Remove Companion',
                companionData: 'Companion Data',
                name: 'Name',
                surname: 'Surname',
                
                // File upload
                dragDropFiles: 'Drag and drop files here or click to select',
                supportedFormats: 'Supported formats: JPG, PNG, PDF (max. 3MB)',
                uploadedFiles: 'Uploaded Files',
                removeFile: 'Remove file',
                fileTooLarge: 'File is too large (max. 3MB)',
                invalidFileType: 'Invalid file type',
                
                // CAPTCHA
                captchaCode: 'Verification Code',
                enterCaptcha: 'Enter the code shown',
                regenerateCaptcha: 'Generate new code',
                
                // Messages
                error: 'Error',
                success: 'Success',
                fillRequiredFields: 'Please fill all required fields',
                fillLocationFields: 'Please fill all location fields',
                fillColombiaFields: 'Please fill all additional fields',
                invalidCaptcha: 'Invalid verification code',
                checkinSuccess: 'Check-in completed successfully',
                submitError: 'Error submitting form',
                reservationNotFound: 'Reservation not found',
                submitting: 'Submitting...',
                submitCheckin: 'Complete Check-in',
                searching: 'Searching...',
                
                // Placeholders
                enterReservationNumber: 'Enter your reservation number',
                enterIdNumber: 'Enter your ID number',
                enterPhone: 'Enter your phone',
                enterEmail: 'Enter your email',
                enterComments: 'Additional comments (optional)',
                enterAddress: 'Enter your residence address',
                enterNationality: 'Enter your nationality',
                enterResidenceCity: 'Enter your residence city',
                
                // Additional
                noCompanions: 'No companions added',
                selectReason: 'Select a reason'
            },
            
            PT: {
                hotelCheckin: 'Check-in do Hotel',
                searchReservation: 'Busque sua reserva para continuar',
                checkinForm: 'Formulário de Check-in',
                welcome: 'Bem-vindo',
                mainGuestData: 'Dados do Hóspede Principal',
                locationData: 'Dados de Localização',
                additionalData: 'Dados Adicionais',
                uploadDocuments: 'Carregar Documentos',
                security: 'Verificação de Segurança',
                
                // Form fields
                reservationNumber: 'Número da Reserva',
                searchReservationBtn: 'Buscar Reserva',
                idNumber: 'Número de Identificação',
                phone: 'Telefone',
                email: 'Email',
                birthDate: 'Data de Nascimento',
                comments: 'Comentários',
                
                // Location fields
                country: 'País',
                state: 'Estado/Província',
                city: 'Cidade',
                selectCountry: 'Selecione um país',
                selectState: 'Selecione um estado',
                selectCity: 'Selecione uma cidade',
                loadingCountries: 'Carregando países...',
                loadingStates: 'Carregando estados...',
                loadingCities: 'Carregando cidades...',
                
                // Colombia fields
                residenceAddress: 'Endereço de Residência',
                nationality: 'Nacionalidade',
                origin: 'Origem',
                destination: 'Destino',
                arrivalDateTime: 'Data e Hora de Chegada',
                residenceCity: 'Cidade de Residência',
                travelReason: 'Motivo da Viagem',
                
                // Travel reasons
                tourism: 'Turismo',
                business: 'Negócios',
                study: 'Estudos',
                health: 'Saúde',
                transit: 'Trânsito',
                family: 'Família',
                work: 'Trabalho',
                other: 'Outro',
                religion: 'Religião',
                shopping: 'Compras',
                
                // Companions
                companions: 'Acompanhantes',
                numGuests: 'Número de Hóspedes',
                addCompanion: 'Adicionar Acompanhante',
                removeCompanion: 'Remover Acompanhante',
                companionData: 'Dados do Acompanhante',
                name: 'Nome',
                surname: 'Sobrenome',
                
                // File upload
                dragDropFiles: 'Arraste e solte arquivos aqui ou clique para selecionar',
                supportedFormats: 'Formatos suportados: JPG, PNG, PDF (máx. 3MB)',
                uploadedFiles: 'Arquivos Carregados',
                removeFile: 'Remover arquivo',
                fileTooLarge: 'Arquivo muito grande (máx. 3MB)',
                invalidFileType: 'Tipo de arquivo inválido',
                
                // CAPTCHA
                captchaCode: 'Código de Verificação',
                enterCaptcha: 'Digite o código mostrado',
                regenerateCaptcha: 'Gerar novo código',
                
                // Messages
                error: 'Erro',
                success: 'Sucesso',
                fillRequiredFields: 'Por favor, preencha todos os campos obrigatórios',
                fillLocationFields: 'Por favor, preencha todos os campos de localização',
                fillColombiaFields: 'Por favor, preencha todos os campos adicionais',
                invalidCaptcha: 'Código de verificação incorreto',
                checkinSuccess: 'Check-in realizado com sucesso',
                submitError: 'Erro ao enviar formulário',
                reservationNotFound: 'Reserva não encontrada',
                submitting: 'Enviando...',
                submitCheckin: 'Completar Check-in',
                searching: 'Buscando...',
                
                // Placeholders
                enterReservationNumber: 'Digite o número da sua reserva',
                enterIdNumber: 'Digite seu número de identificação',
                enterPhone: 'Digite seu telefone',
                enterEmail: 'Digite seu email',
                enterComments: 'Comentários adicionais (opcional)',
                enterAddress: 'Digite seu endereço de residência',
                enterNationality: 'Digite sua nacionalidade',
                enterResidenceCity: 'Digite sua cidade de residência',
                
                // Additional
                noCompanions: 'Nenhum acompanhante adicionado',
                selectReason: 'Selecione um motivo'
            }
        };

        // Colombia cities data
        // Catálogo parcial de ciudades de Colombia con código y nombre (ampliable)
        const colombiaCityCatalog = [
            { code: '5001', name: 'MEDELLÍN' },
            { code: '5002', name: 'ABEJORRAL' },
            { code: '5004', name: 'ABRIAQUÍ' },
            { code: '5021', name: 'ALEJANDRÍA' },
            { code: '5030', name: 'AMAGÁ' },
            { code: '5031', name: 'AMALFI' },
            { code: '5034', name: 'ANDES' },
            { code: '5036', name: 'ANGELÓPOLIS' },
            { code: '5038', name: 'ANGOSTURA' },
            { code: '5040', name: 'ANORÍ' },
            { code: '5042', name: 'SANTAFÉ DE ANTIOQUIA' },
            { code: '5044', name: 'ANZA' },
            { code: '5045', name: 'APARTADÓ' },
            { code: '5051', name: 'ARBOLETES' },
            { code: '5055', name: 'ARGELIA' },
            { code: '5059', name: 'ARMENIA' },
            { code: '5079', name: 'BARBOSA' },
            { code: '5086', name: 'BELMIRA' },
            { code: '5088', name: 'BELLO' },
    { code: '5091', name: 'BETANIA' },
    { code: '5093', name: 'BETULIA' },
    { code: '5101', name: 'CIUDAD BOLÍVAR' },
    { code: '5107', name: 'BRICEÑO' },
    { code: '5113', name: 'BURITICÁ' },
    { code: '5120', name: 'CÁCERES' },
    { code: '5125', name: 'CAICEDO' },
    { code: '5129', name: 'CALDAS' },
    { code: '5134', name: 'CAMPAMENTO' },
    { code: '5138', name: 'CAÑASGORDAS' },
    { code: '5142', name: 'CARACOLÍ' },
    { code: '5145', name: 'CARAMANTA' },
    { code: '5147', name: 'CAREPA' },
    { code: '5148', name: 'EL CARMEN DE VIBORAL' },
    { code: '5150', name: 'CAROLINA' },
    { code: '5154', name: 'CAUCASIA' },
    { code: '5172', name: 'CHIGORODÓ' },
    { code: '5190', name: 'CISNEROS' },
    { code: '5197', name: 'COCORNÁ' },
    { code: '5206', name: 'CONCEPCIÓN' },
    { code: '5209', name: 'CONCORDIA' },
    { code: '5212', name: 'COPACABANA' },
    { code: '5234', name: 'DABEIBA' },
    { code: '5237', name: 'DONMATÍAS' },
    { code: '5240', name: 'EBÉJICO' },
    { code: '5250', name: 'EL BAGRE' },
    { code: '5264', name: 'ENTRERRIOS' },
    { code: '5266', name: 'ENVIGADO' },
    { code: '5282', name: 'FREDONIA' },
    { code: '5284', name: 'FRONTINO' },
    { code: '5306', name: 'GIRALDO' },
    { code: '5308', name: 'GIRARDOTA' },
    { code: '5310', name: 'GÓMEZ PLATA' },
    { code: '5313', name: 'GRANADA' },
    { code: '5315', name: 'GUADALUPE' },
    { code: '5318', name: 'GUARNE' },
    { code: '5321', name: 'GUATAPE' },
    { code: '5347', name: 'HELICONIA' },
    { code: '5353', name: 'HISPANIA' },
    { code: '5360', name: 'ITAGUI' },
    { code: '5361', name: 'ITUANGO' },
    { code: '5364', name: 'JARDÍN' },
    { code: '5368', name: 'JERICÓ' },
    { code: '5376', name: 'LA CEJA' },
    { code: '5380', name: 'LA ESTRELLA' },
    { code: '5390', name: 'LA PINTADA' },
    { code: '5400', name: 'LA UNIÓN' },
    { code: '5411', name: 'LIBORINA' },
    { code: '5425', name: 'MACEO' },
    { code: '5440', name: 'MARINILLA' },
    { code: '5467', name: 'MONTEBELLO' },
    { code: '5475', name: 'MURINDÓ' },
    { code: '5480', name: 'MUTATÁ' },
    { code: '5483', name: 'NARIÑO' },
    { code: '5490', name: 'NECOCLÍ' },
    { code: '5495', name: 'NECHÍ' },
    { code: '5501', name: 'OLAYA' },
    { code: '5541', name: 'PEÑOL' },
    { code: '5543', name: 'PEQUE' },
    { code: '5576', name: 'PUEBLORRICO' },
    { code: '5579', name: 'PUERTO BERRÍO' },
    { code: '5585', name: 'PUERTO NARE' },
    { code: '5591', name: 'PUERTO TRIUNFO' },
    { code: '5604', name: 'REMEDIOS' },
    { code: '5607', name: 'RETIRO' },
    { code: '5615', name: 'RIONEGRO' },
    { code: '5628', name: 'SABANALARGA' },
    { code: '5631', name: 'SABANETA' },
    { code: '5642', name: 'SALGAR' },
    { code: '5647', name: 'SAN ANDRÉS DE CUERQUÍA' },
    { code: '5649', name: 'SAN CARLOS' },
    { code: '5652', name: 'SAN FRANCISCO' },
    { code: '5656', name: 'SAN JERÓNIMO' },
    { code: '5658', name: 'SAN JOSÉ DE LA MONTAÑA' },
    { code: '5659', name: 'SAN JUAN DE URABÁ' },
    { code: '5660', name: 'SAN LUIS' },
    { code: '5664', name: 'SAN PEDRO DE LOS MILAGROS' },
    { code: '5665', name: 'SAN PEDRO DE URABA' },
    { code: '5667', name: 'SAN RAFAEL' },
    { code: '5670', name: 'SAN ROQUE' },
    { code: '5674', name: 'SAN VICENTE FERRER' },
    { code: '5679', name: 'SANTA BÁRBARA' },
    { code: '5686', name: 'SANTA ROSA DE OSOS' },
    { code: '5690', name: 'SANTO DOMINGO' },
    { code: '5697', name: 'EL SANTUARIO' },
    { code: '5736', name: 'SEGOVIA' },
    { code: '5756', name: 'SONSON' },
    { code: '5761', name: 'SOPETRÁN' },
    { code: '5789', name: 'TÁMESIS' },
    { code: '5790', name: 'TARAZÁ' },
    { code: '5792', name: 'TARSO' },
    { code: '5809', name: 'TITIRIBÍ' },
    { code: '5819', name: 'TOLEDO' },
    { code: '5837', name: 'TURBO' },
    { code: '5842', name: 'URAMITA' },
    { code: '5847', name: 'URRAO' },
    { code: '5854', name: 'VALDIVIA' },
    { code: '5856', name: 'VALPARAÍSO' },
    { code: '5858', name: 'VEGACHÍ' },
    { code: '5861', name: 'VENECIA' },
    { code: '5873', name: 'VIGÍA DEL FUERTE' },
    { code: '5885', name: 'YALÍ' },
    { code: '5887', name: 'YARUMAL' },
    { code: '5890', name: 'YOLOMBÓ' },
    { code: '5893', name: 'YONDÓ' },
    { code: '5895', name: 'ZARAGOZA' },
    { code: '8001', name: 'BARRANQUILLA' },
    { code: '8078', name: 'BARANOA' },
    { code: '8137', name: 'CAMPO DE LA CRUZ' },
    { code: '8141', name: 'CANDELARIA' },
    { code: '8296', name: 'GALAPA' },
    { code: '8372', name: 'JUAN DE ACOSTA' },
    { code: '8421', name: 'LURUACO' },
    { code: '8433', name: 'MALAMBO' },
    { code: '8436', name: 'MANATÍ' },
    { code: '8520', name: 'PALMAR DE VARELA' },
    { code: '8549', name: 'PIOJÓ' },
    { code: '8558', name: 'POLONUEVO' },
    { code: '8560', name: 'PONEDERA' },
    { code: '8573', name: 'PUERTO COLOMBIA' },
    { code: '8606', name: 'REPELÓN' },
    { code: '8634', name: 'SABANAGRANDE' },
    { code: '8638', name: 'SABANALARGA' },
    { code: '8675', name: 'SANTA LUCÍA' },
    { code: '8685', name: 'SANTO TOMÁS' },
    { code: '8758', name: 'SOLEDAD' },
    { code: '8770', name: 'SUAN' },
    { code: '8832', name: 'TUBARÁ' },
    { code: '8849', name: 'USIACURÍ' },
    { code: '11001', name: 'BOGOTÁ, D.C.' },
    { code: '13001', name: 'CARTAGENA' },
    { code: '13006', name: 'ACHÍ' },
    { code: '13030', name: 'ALTOS DEL ROSARIO' },
    { code: '13042', name: 'ARENAL' },
    { code: '13052', name: 'ARJONA' },
    { code: '13062', name: 'ARROYOHONDO' },
    { code: '13074', name: 'BARRANCO DE LOBA' },
    { code: '13140', name: 'CALAMAR' },
    { code: '13160', name: 'CANTAGALLO' },
    { code: '13188', name: 'CICUCO' },
    { code: '13212', name: 'CÓRDOBA' },
    { code: '13222', name: 'CLEMENCIA' },
    { code: '13244', name: 'EL CARMEN DE BOLÍVAR' },
    { code: '13248', name: 'EL GUAMO' },
    { code: '13268', name: 'EL PEÑÓN' },
    { code: '13300', name: 'HATILLO DE LOBA' },
    { code: '13430', name: 'MAGANGUÉ' },
    { code: '13433', name: 'MAHATES' },
    { code: '13440', name: 'MARGARITA' },
    { code: '13442', name: 'MARÍA LA BAJA' },
    { code: '13458', name: 'MONTECRISTO' },
    { code: '13468', name: 'MOMPÓS' },
    { code: '13473', name: 'MORALES' },
    { code: '13490', name: 'NOROSÍ' },
    { code: '13549', name: 'PINILLOS' },
    { code: '13580', name: 'REGIDOR' },
    { code: '13600', name: 'RÍO VIEJO' },
    { code: '13620', name: 'SAN CRISTÓBAL' },
    { code: '13647', name: 'SAN ESTANISLAO' },
    { code: '13650', name: 'SAN FERNANDO' },
    { code: '13654', name: 'SAN JACINTO' },
    { code: '13655', name: 'SAN JACINTO DEL CAUCA' },
    { code: '13657', name: 'SAN JUAN NEPOMUCENO' },
    { code: '13667', name: 'SAN MARTÍN DE LOBA' },
    { code: '13670', name: 'SAN PABLO' },
    { code: '13673', name: 'SANTA CATALINA' },
    { code: '13683', name: 'SANTA ROSA' },
    { code: '13688', name: 'SANTA ROSA DEL SUR' },
    { code: '13744', name: 'SIMITÍ' },
    { code: '13760', name: 'SOPLAVIENTO' },
    { code: '13780', name: 'TALAIGUA NUEVO' },
    { code: '13810', name: 'TIQUISIO' },
    { code: '13836', name: 'TURBACO' },
    { code: '13838', name: 'TURBANÁ' },
    { code: '13873', name: 'VILLANUEVA' },
    { code: '13894', name: 'ZAMBRANO' },
    { code: '15001', name: 'TUNJA' },
    { code: '15022', name: 'ALMEIDA' },
    { code: '15047', name: 'AQUITANIA' },
    { code: '15051', name: 'ARCABUCO' },
    { code: '15087', name: 'BELÉN' },
    { code: '15090', name: 'BERBEO' },
    { code: '15092', name: 'BETÉITIVA' },
    { code: '15097', name: 'BOAVITA' },
    { code: '15104', name: 'BOYACÁ' },
    { code: '15106', name: 'BRICEÑO' },
    { code: '15109', name: 'BUENAVISTA' },
    { code: '15114', name: 'BUSBANZÁ' },
    { code: '15131', name: 'CALDAS' },
    { code: '15135', name: 'CAMPOHERMOSO' },
    { code: '15162', name: 'CERINZA' },
    { code: '15172', name: 'CHINAVITA' },
    { code: '15176', name: 'CHIQUINQUIRÁ' },
    { code: '15180', name: 'CHISCAS' },
    { code: '15183', name: 'CHITA' },
    { code: '15185', name: 'CHITARAQUE' },
    { code: '15187', name: 'CHIVATÁ' },
    { code: '15189', name: 'CIÉNEGA' },
    { code: '15204', name: 'CÓMBITA' },
    { code: '15212', name: 'COPER' },
    { code: '15215', name: 'CORRALES' },
    { code: '15218', name: 'COVARACHÍA' },
    { code: '15223', name: 'CUBARÁ' },
    { code: '15224', name: 'CUCAITA' },
    { code: '15226', name: 'CUÍTIVA' },
    { code: '15232', name: 'CHÍQUIZA' },
    { code: '15236', name: 'CHIVOR' },
    { code: '15238', name: 'DUITAMA' },
    { code: '15244', name: 'EL COCUY' },
    { code: '15248', name: 'EL ESPINO' },
    { code: '15272', name: 'FIRAVITOBA' },
    { code: '15276', name: 'FLORESTA' },
    { code: '15293', name: 'GACHANTIVÁ' },
    { code: '15296', name: 'GAMEZA' },
    { code: '15299', name: 'GARAGOA' },
    { code: '15317', name: 'GUACAMAYAS' },
    { code: '15322', name: 'GUATEQUE' },
    { code: '15325', name: 'GUAYATÁ' },
    { code: '15332', name: 'GÜICÁN' },
    { code: '15362', name: 'IZA' },
    { code: '15367', name: 'JENESANO' },
    { code: '15368', name: 'JERICÓ' },
    { code: '15377', name: 'LABRANZAGRANDE' },
    { code: '15380', name: 'LA CAPILLA' },
    { code: '15401', name: 'LA VICTORIA' },
    { code: '15403', name: 'LA UVITA' },
    { code: '15407', name: 'VILLA DE LEYVA' },
    { code: '15425', name: 'MACANAL' },
    { code: '15442', name: 'MARIPÍ' },
    { code: '15455', name: 'MIRAFLORES' },
    { code: '15464', name: 'MONGUA' },
    { code: '15466', name: 'MONGUÍ' },
    { code: '15469', name: 'MONIQUIRÁ' },
    { code: '15476', name: 'MOTAVITA' },
    { code: '15480', name: 'MUZO' },
    { code: '15491', name: 'NOBSA' },
    { code: '15494', name: 'NUEVO COLÓN' },
    { code: '15500', name: 'OICATÁ' },
    { code: '15507', name: 'OTANCHE' },
    { code: '15511', name: 'PACHAVITA' },
    { code: '15514', name: 'PÁEZ' },
    { code: '15516', name: 'PAIPA' },
    { code: '15518', name: 'PAJARITO' },
    { code: '15522', name: 'PANQUEBA' },
    { code: '15531', name: 'PAUNA' },
    { code: '15533', name: 'PAYA' },
    { code: '15537', name: 'PAZ DE RÍO' },
    { code: '15542', name: 'PESCA' },
    { code: '15550', name: 'PISBA' },
    { code: '15572', name: 'PUERTO BOYACÁ' },
    { code: '15580', name: 'QUÍPAMA' },
    { code: '15599', name: 'RAMIRIQUÍ' },
    { code: '15600', name: 'RÁQUIRA' },
    { code: '15621', name: 'RONDÓN' },
    { code: '15632', name: 'SABOYÁ' },
    { code: '15638', name: 'SÁCHICA' },
    { code: '15646', name: 'SAMACÁ' },
    { code: '15660', name: 'SAN EDUARDO' },
    { code: '15664', name: 'SAN JOSÉ DE PARE' },
    { code: '15667', name: 'SAN LUIS DE GACENO' },
    { code: '15673', name: 'SAN MATEO' },
    { code: '15676', name: 'SAN MIGUEL DE SEMA' },
    { code: '15681', name: 'SAN PABLO DE BORBUR' },
    { code: '15686', name: 'SANTANA' },
    { code: '15690', name: 'SANTA MARÍA' },
    { code: '15693', name: 'SANTA ROSA DE VITERBO' },
    { code: '15696', name: 'SANTA SOFÍA' },
    { code: '15720', name: 'SATIVANORTE' },
    { code: '15723', name: 'SATIVASUR' },
    { code: '15740', name: 'SIACHOQUE' },
    { code: '15753', name: 'SOATÁ' },
    { code: '15755', name: 'SOCOTÁ' },
    { code: '15757', name: 'SOCHA' },
    { code: '15759', name: 'SOGAMOSO' },
    { code: '15761', name: 'SOMONDOCO' },
    { code: '15762', name: 'SORA' },
    { code: '15763', name: 'SOTAQUIRÁ' },
    { code: '15764', name: 'SORACÁ' },
    { code: '15774', name: 'SUSACÓN' },
    { code: '15776', name: 'SUTAMARCHÁN' },
    { code: '15778', name: 'SUTATENZA' },
    { code: '15790', name: 'TASCO' },
    { code: '15798', name: 'TENZA' },
    { code: '15804', name: 'TIBANÁ' },
    { code: '15806', name: 'TIBASOSA' },
    { code: '15808', name: 'TINJACÁ' },
    { code: '15810', name: 'TIPACOQUE' },
    { code: '15814', name: 'TOCA' },
    { code: '15816', name: 'TOGÜÍ' },
    { code: '15820', name: 'TÓPAGA' },
    { code: '15822', name: 'TOTA' },
    { code: '15832', name: 'TUNUNGUÁ' },
    { code: '15835', name: 'TURMEQUÉ' },
    { code: '15837', name: 'TUTA' },
    { code: '15839', name: 'TUTAZÁ' },
    { code: '15842', name: 'UMBITA' },
    { code: '15861', name: 'VENTAQUEMADA' },
    { code: '15879', name: 'VIRACACHÁ' },
    { code: '15897', name: 'ZETAQUIRA' },
    { code: '17001', name: 'MANIZALES' },
    { code: '17013', name: 'AGUADAS' },
    { code: '17042', name: 'ANSERMA' },
    { code: '17050', name: 'ARANZAZU' },
    { code: '17088', name: 'BELALCÁZAR' },
    { code: '17174', name: 'CHINCHINÁ' },
    { code: '17272', name: 'FILADELFIA' },
    { code: '17380', name: 'LA DORADA' },
    { code: '17388', name: 'LA MERCED' },
    { code: '17433', name: 'MANZANARES' },
    { code: '17442', name: 'MARMATO' },
    { code: '17444', name: 'MARQUETALIA' },
    { code: '17446', name: 'MARULANDA' },
    { code: '17486', name: 'NEIRA' },
    { code: '17495', name: 'NORCASIA' },
    { code: '17513', name: 'PÁCORA' },
    { code: '17524', name: 'PALESTINA' },
    { code: '17541', name: 'PENSILVANIA' },
    { code: '17614', name: 'RIOSUCIO' },
    { code: '17616', name: 'RISARALDA' },
    { code: '17653', name: 'SALAMINA' },
    { code: '17662', name: 'SAMANÁ' },
    { code: '17665', name: 'SAN JOSÉ' },
    { code: '17777', name: 'SUPÍA' },
    { code: '17867', name: 'VICTORIA' },
    { code: '17873', name: 'VILLAMARÍA' },
    { code: '17877', name: 'VITERBO' },
    { code: '18001', name: 'FLORENCIA' },
    { code: '18029', name: 'ALBANIA' },
    { code: '18094', name: 'BELÉN DE LOS ANDAQUÍES' },
    { code: '18150', name: 'CARTAGENA DEL CHAIRÁ' },
    { code: '18205', name: 'CURILLO' },
    { code: '18247', name: 'EL DONCELLO' },
    { code: '18256', name: 'EL PAUJIL' },
    { code: '18410', name: 'LA MONTAÑITA' },
    { code: '18460', name: 'MILÁN' },
    { code: '18479', name: 'MORELIA' },
    { code: '18592', name: 'PUERTO RICO' },
    { code: '18610', name: 'SAN JOSÉ DEL FRAGUA' },
    { code: '18753', name: 'SAN VICENTE DEL CAGUÁN' },
    { code: '18756', name: 'SOLANO' },
    { code: '18785', name: 'SOLITA' },
    { code: '18860', name: 'VALPARAÍSO' },
    { code: '19001', name: 'POPAYÁN' },
    { code: '19022', name: 'ALMAGUER' },
    { code: '19050', name: 'ARGELIA' },
    { code: '19075', name: 'BALBOA' },
    { code: '19100', name: 'BOLÍVAR' },
    { code: '19110', name: 'BUENOS AIRES' },
    { code: '19130', name: 'CAJIBÍO' },
    { code: '19137', name: 'CALDONO' },
    { code: '19142', name: 'CALOTO' },
    { code: '19212', name: 'CORINTO' },
    { code: '19256', name: 'EL TAMBO' },
    { code: '19290', name: 'FLORENCIA' },
    { code: '19300', name: 'GUACHENÉ' },
    { code: '19318', name: 'GUAPI' },
    { code: '19355', name: 'INZÁ' },
    { code: '19364', name: 'JAMBALÓ' },
    { code: '19392', name: 'LA SIERRA' },
    { code: '19397', name: 'LA VEGA' },
    { code: '19418', name: 'LÓPEZ' },
    { code: '19450', name: 'MERCADERES' },
    { code: '19455', name: 'MIRANDA' },
    { code: '19473', name: 'MORALES' },
    { code: '19513', name: 'PADILLA' },
    { code: '19517', name: 'PAEZ' },
    { code: '19532', name: 'PATÍA' },
    { code: '19533', name: 'PIAMONTE' },
    { code: '19548', name: 'PIENDAMÓ' },
    { code: '19573', name: 'PUERTO TEJADA' },
    { code: '19585', name: 'PURACÉ' },
    { code: '19622', name: 'ROSAS' },
    { code: '19693', name: 'SAN SEBASTIÁN' },
    { code: '19698', name: 'SANTANDER DE QUILICHAO' },
    { code: '19701', name: 'SANTA ROSA' },
    { code: '19743', name: 'SILVIA' },
    { code: '19760', name: 'SOTARA' },
    { code: '19780', name: 'SUÁREZ' },
    { code: '19785', name: 'SUCRE' },
    { code: '19807', name: 'TIMBÍO' },
    { code: '19809', name: 'TIMBIQUÍ' },
    { code: '19821', name: 'TORIBIO' },
    { code: '19824', name: 'TORORÓ' },
    { code: '19845', name: 'VILLA RICA' },
    { code: '20001', name: 'VALLEDUPAR' },
    { code: '20011', name: 'AGUACHICA' },
    { code: '20013', name: 'AGUSTÍN CODAZZI' },
    { code: '20032', name: 'ASTREA' },
    { code: '20045', name: 'BECERRIL' },
    { code: '20060', name: 'BOSCONIA' },
    { code: '20175', name: 'CHIMICHAGUA' },
    { code: '20178', name: 'CHIRIGUANÁ' },
    { code: '20228', name: 'CURUMANÍ' },
    { code: '20238', name: 'EL COPEY' },
    { code: '20250', name: 'EL PASO' },
    { code: '20295', name: 'GAMARRA' },
    { code: '20310', name: 'GONZÁLEZ' },
    { code: '20383', name: 'LA GLORIA' },
    { code: '20400', name: 'LA JAGUA DE IBIRICO' },
    { code: '20443', name: 'MANAURE' },
    { code: '20517', name: 'PAILITAS' },
    { code: '20550', name: 'PELAYA' },
    { code: '20570', name: 'PUEBLO BELLO' },
    { code: '20614', name: 'RÍO DE ORO' },
    { code: '20621', name: 'LA PAZ' },
    { code: '20710', name: 'SAN ALBERTO' },
    { code: '20750', name: 'SAN DIEGO' },
    { code: '20770', name: 'SAN MARTÍN' },
    { code: '20787', name: 'TAMALAMEQUE' },
    { code: '23001', name: 'MONTERÍA' },
    { code: '23068', name: 'AYAPEL' },
    { code: '23079', name: 'BUENAVISTA' },
    { code: '23090', name: 'CANALETE' },
    { code: '23162', name: 'CERETÉ' },
    { code: '23168', name: 'CHIMÁ' },
    { code: '23182', name: 'CHINÚ' },
    { code: '23189', name: 'CIÉNAGA DE ORO' },
    { code: '23300', name: 'COTORRA' },
    { code: '23350', name: 'LA APARTADA' },
    { code: '23417', name: 'LORICA' },
    { code: '23419', name: 'LOS CÓRDOBAS' },
    { code: '23464', name: 'MOMIL' },
    { code: '23466', name: 'MONTELÍBANO' },
    { code: '23500', name: 'MOÑITOS' },
    { code: '23555', name: 'PLANETA RICA' },
    { code: '23570', name: 'PUEBLO NUEVO' },
    { code: '23574', name: 'PUERTO ESCONDIDO' },
    { code: '23580', name: 'PUERTO LIBERTADOR' },
    { code: '23586', name: 'PURÍSIMA' },
    { code: '23660', name: 'SAHAGÚN' },
    { code: '23670', name: 'SAN ANDRÉS DE SOTAVENTO' },
    { code: '23672', name: 'SAN ANTERO' },
    { code: '23675', name: 'SAN BERNARDO DEL VIENTO' },
    { code: '23678', name: 'SAN CARLOS' },
    { code: '23682', name: 'SAN JOSÉ DE URÉ' },
    { code: '23686', name: 'SAN PELAYO' },
    { code: '23807', name: 'TIERRALTA' },
    { code: '23815', name: 'TUCHÍN' },
    { code: '23855', name: 'VALENCIA' },
    { code: '25001', name: 'AGUA DE DIOS' },
    { code: '25019', name: 'ALBÁN' },
    { code: '25035', name: 'ANAPOIMA' },
    { code: '25040', name: 'ANOLAIMA' },
    { code: '25053', name: 'ARBELÁEZ' },
    { code: '25086', name: 'BELTRÁN' },
    { code: '25095', name: 'BITUIMA' },
    { code: '25099', name: 'BOJACÁ' },
    { code: '25120', name: 'CABRERA' },
    { code: '25123', name: 'CACHIPAY' },
    { code: '25126', name: 'CAJICÁ' },
    { code: '25148', name: 'CAPARRAPÍ' },
    { code: '25151', name: 'CAQUEZA' },
    { code: '25154', name: 'CARMEN DE CARUPA' },
    { code: '25168', name: 'CHAGUANÍ' },
    { code: '25175', name: 'CHÍA' },
    { code: '25178', name: 'CHIPAQUE' },
    { code: '25181', name: 'CHOACHÍ' },
    { code: '25183', name: 'CHOCONTÁ' },
    { code: '25200', name: 'COGUA' },
    { code: '25214', name: 'COTA' },
    { code: '25224', name: 'CUCUNUBÁ' },
    { code: '25245', name: 'EL COLEGIO' },
    { code: '25258', name: 'EL PEÑÓN' },
    { code: '25260', name: 'EL ROSAL' },
    { code: '25269', name: 'FACATATIVÁ' },
    { code: '25279', name: 'FÓMEQUE' },
    { code: '25281', name: 'FOSCA' },
    { code: '25286', name: 'FUNZA' },
    { code: '25288', name: 'FÚQUENE' },
    { code: '25290', name: 'FUSAGASUGÁ' },
    { code: '25293', name: 'GACHALÁ' },
    { code: '25295', name: 'GACHANCIPÁ' },
    { code: '25297', name: 'GACHETÁ' },
    { code: '25299', name: 'GAMA' },
    { code: '25307', name: 'GIRARDOT' },
    { code: '25312', name: 'GRANADA' },
    { code: '25317', name: 'GUACHETÁ' },
    { code: '25320', name: 'GUADUAS' },
    { code: '25322', name: 'GUASCA' },
    { code: '25324', name: 'GUATAQUÍ' },
    { code: '25326', name: 'GUATAVITA' },
    { code: '25328', name: 'GUAYABAL DE SIQUIMA' },
    { code: '25335', name: 'GUAYABETAL' },
    { code: '25339', name: 'GUTIÉRREZ' },
    { code: '25368', name: 'JERUSALÉN' },
    { code: '25372', name: 'JUNÍN' },
    { code: '25377', name: 'LA CALERA' },
    { code: '25386', name: 'LA MESA' },
    { code: '25394', name: 'LA PALMA' },
    { code: '25398', name: 'LA PEÑA' },
    { code: '25402', name: 'LA VEGA' },
    { code: '25407', name: 'LENGUAZAQUE' },
    { code: '25426', name: 'MACHETÁ' },
    { code: '25430', name: 'MADRID' },
    { code: '25436', name: 'MANTA' },
    { code: '25438', name: 'MEDINA' },
    { code: '25473', name: 'MOSQUERA' },
    { code: '25483', name: 'NARIÑO' },
    { code: '25486', name: 'NEMOCÓN' },
    { code: '25488', name: 'NILO' },
    { code: '25489', name: 'NIMAIMA' },
    { code: '25491', name: 'NOCAIMA' },
    { code: '25506', name: 'VENECIA' },
    { code: '25513', name: 'PACHO' },
    { code: '25518', name: 'PAIME' },
    { code: '25524', name: 'PANDI' },
    { code: '25530', name: 'PARATEBUENO' },
    { code: '25535', name: 'PASCA' },
    { code: '25572', name: 'PUERTO SALGAR' },
    { code: '25580', name: 'PULÍ' },
    { code: '25592', name: 'QUEBRADANEGRA' },
    { code: '25594', name: 'QUETAME' },
    { code: '25596', name: 'QUIPILE' },
    { code: '25599', name: 'APULO' },
    { code: '25612', name: 'RICAURTE' },
    { code: '25645', name: 'SAN ANTONIO DEL TEQUENDAMA' },
    { code: '25649', name: 'SAN BERNARDO' },
    { code: '25653', name: 'SAN CAYETANO' },
    { code: '25658', name: 'SAN FRANCISCO' },
    { code: '25662', name: 'SAN JUAN DE RÍO SECO' },
    { code: '25667', name: 'SASAIMA' },
    { code: '25675', name: 'SESQUILÉ' },
    { code: '25677', name: 'SIBAATE' },
    { code: '25679', name: 'SILVANIA' },
    { code: '25681', name: 'SIMIJACA' },
    { code: '25685', name: 'SOACHA' },
    { code: '25686', name: 'SOPÓ' },
    { code: '25688', name: 'SUBACHOQUE' },
    { code: '25690', name: 'SUESCA' },
    { code: '25691', name: 'SUPATÁ' },
    { code: '25693', name: 'SUSA' },
    { code: '25695', name: 'SUTATAUSA' },
    { code: '25697', name: 'TABIO' },
    { code: '25699', name: 'TAUSA' },
    { code: '25718', name: 'TENA' },
    { code: '25736', name: 'TENJO' },
    { code: '25738', name: 'TIBACUY' },
    { code: '25740', name: 'TIBIRITA' },
    { code: '25743', name: 'TOCAIMA' },
    { code: '25745', name: 'TOCANCIPÁ' },
    { code: '25754', name: 'TOPAIPÍ' },
    { code: '25758', name: 'UBALÁ' },
    { code: '25762', name: 'UBAQUE' },
    { code: '25764', name: 'UBATÉ' },
    { code: '25766', name: 'UNE' },
    { code: '25769', name: 'ÚTICA' },
    { code: '25772', name: 'VERGARA' },
    { code: '25777', name: 'VIANÍ' },
    { code: '25779', name: 'VILLAGÓMEZ' },
    { code: '25781', name: 'VILLAPINZÓN' },
    { code: '25785', name: 'VILLETA' },
    { code: '25793', name: 'VIOTÁ' },
    { code: '25797', name: 'YACOPÍ' },
    { code: '25799', name: 'ZIPACÓN' },
    { code: '25801', name: 'ZIPAQUIRÁ' },
        ];

        function getColombiaCityLabelByCode(code) { // para el selector de origen
            if (!code) return '';
            const item = colombiaCityCatalog.find(c => c.code === String(code));
            return item ? `${item.name}` : code;
        }

        const colombiaPaisCatalog = [
            { code: 'AD', name: 'Andorra' },
            { code: 'AE', name: 'Emiratos Árabes Unidos' },
            { code: 'AF', name: 'Afganistán' },
            { code: 'AG', name: 'Antigua y Barbuda' },
            { code: 'AL', name: 'Albania' },
            { code: 'AM', name: 'Armenia' },
            { code: 'AN', name: 'Antillas Neerlandesas' },
            { code: 'AO', name: 'Angola' },
            { code: 'AQ', name: 'Antártida' },
            { code: 'AR', name: 'Argentina' },
            { code: 'AS', name: 'Samoa Americana' },
            { code: 'AT', name: 'Austria' },
            { code: 'AU', name: 'Australia' },
            { code: 'AX', name: 'Islas Åland' },
            { code: 'AZ', name: 'Azerbaiyán' },
            { code: 'BA', name: 'Bosnia y Herzegovina' },
            { code: 'BB', name: 'Barbados' },
            { code: 'BD', name: 'Bangladesh' },
            { code: 'BE', name: 'Bélgica' },
            { code: 'BF', name: 'Burkina Faso' },
            { code: 'BG', name: 'Bulgaria' },
            { code: 'BH', name: 'Bahrain' },
            { code: 'BI', name: 'Burundi' },
            { code: 'BJ', name: 'Benín' },
            { code: 'BL', name: 'San Bartolomé' },
            { code: 'BM', name: 'Bermudas' },
            { code: 'BN', name: 'Brunéi' },
            { code: 'BO', name: 'Bolivia' },
            { code: 'BQ', name: 'Bonaire, San Eustaquio y Saba' },
            { code: 'BR', name: 'Brasil' },
            { code: 'BS', name: 'Bahamas' },
            { code: 'BT', name: 'Bután' },
            { code: 'BV', name: 'Isla Bouvet' },
            { code: 'BW', name: 'Botsuana' },
            { code: 'BY', name: 'Bielorrusia' },
            { code: 'BZ', name: 'Belice' },
            { code: 'CA', name: 'Canadá' },
            { code: 'CC', name: 'Islas Cocos (Keeling)' },
            { code: 'CD', name: 'República Democrática del Congo' },
            { code: 'CF', name: 'República Centroafricana' },
            { code: 'CG', name: 'Congo' },
            { code: 'CH', name: 'Suiza' },
            { code: 'CI', name: 'Costa de Marfil' },
            { code: 'CK', name: 'Islas Cook' },
            { code: 'CL', name: 'Chile' },
            { code: 'CM', name: 'Camerún' },
            { code: 'CN', name: 'China' },
            { code: 'CO', name: 'Colombia' },
            { code: 'CR', name: 'Costa Rica' },
            { code: 'CU', name: 'Cuba' },
            { code: 'CV', name: 'Cabo Verde' },
            { code: 'CW', name: 'Curaçao' },
            { code: 'CX', name: 'Isla de Navidad' },
            { code: 'CY', name: 'Chipre' },
            { code: 'CZ', name: 'República Checa' },
            { code: 'DE', name: 'Alemania' },
            { code: 'DJ', name: 'Djibouti' },
            { code: 'DK', name: 'Dinamarca' },
            { code: 'DM', name: 'Dominica' },
            { code: 'DO', name: 'República Dominicana' },
            { code: 'DZ', name: 'Argelia' },
            { code: 'EC', name: 'Ecuador' },
            { code: 'EE', name: 'Estonia' },
            { code: 'EG', name: 'Egipto' },
            { code: 'EH', name: 'Sahara Occidental' },
            { code: 'ER', name: 'Eritrea' },
            { code: 'ES', name: 'España' },
            { code: 'ET', name: 'Etiopía' },
            { code: 'FI', name: 'Finlandia' },
            { code: 'FJ', name: 'Fiji' },
            { code: 'FK', name: 'Islas Malvinas' },
            { code: 'FM', name: 'Micronesia' },
            { code: 'FO', name: 'Islas Feroe' },
            { code: 'FR', name: 'Francia' },
            { code: 'GA', name: 'Gabón' },
            { code: 'GB', name: 'Reino Unido' },
            { code: 'GD', name: 'Granada' },
            { code: 'GE', name: 'Georgia' },
            { code: 'GF', name: 'Guayana Francesa' },
            { code: 'GG', name: 'Guernsey' },
            { code: 'GH', name: 'Ghana' },
            { code: 'GI', name: 'Gibraltar' },
            { code: 'GL', name: 'Groenlandia' },
            { code: 'GM', name: 'Gambia' },
            { code: 'GN', name: 'Guinea' },
            { code: 'GP', name: 'Guadalupe' },
            { code: 'GQ', name: 'Guinea Ecuatorial' },
            { code: 'GR', name: 'Grecia' },
            { code: 'GS', name: 'Georgia del Sur y las Islas Sandwich del Sur' },
            { code: 'GT', name: 'Guatemala' },
            { code: 'GU', name: 'Guam' },
            { code: 'GW', name: 'Guinea-Bissau' },
            { code: 'GY', name: 'Guyana' },
            { code: 'HK', name: 'Hong Kong' },
            { code: 'HM', name: 'Islas Heard y McDonald' },
            { code: 'HN', name: 'Honduras' },
            { code: 'HR', name: 'Croacia' },
            { code: 'HT', name: 'Haití' },
            { code: 'HU', name: 'Hungría' },
            { code: 'ID', name: 'Indonesia' },
            { code: 'IE', name: 'Irlanda' },
            { code: 'IL', name: 'Israel' },
            { code: 'IM', name: 'Isla de Man' },
            { code: 'IN', name: 'India' },
            { code: 'IO', name: 'Territorio Británico del Océano Índico' },
            { code: 'IQ', name: 'Irak' },
            { code: 'IR', name: 'Irán' },
            { code: 'IS', name: 'Islandia' },
            { code: 'IT', name: 'Italia' },
            { code: 'JE', name: 'Jersey' },
            { code: 'JM', name: 'Jamaica' },
            { code: 'JO', name: 'Jordania' },
            { code: 'JP', name: 'Japón' },
            { code: 'KE', name: 'Kenia' },
            { code: 'KG', name: 'Kirguistán' },
            { code: 'KH', name: 'Camboya' },
            { code: 'KI', name: 'Kiribati' },
            { code: 'KM', name: 'Comoras' },
            { code: 'KN', name: 'San Cristóbal y Nieves' },
            { code: 'KP', name: 'Corea del Norte' },
            { code: 'KR', name: 'Corea del Sur' },
            { code: 'KW', name: 'Kuwait' },
            { code: 'KY', name: 'Islas Caimán' },
            { code: 'KZ', name: 'Kazajistán' },
            { code: 'LA', name: 'Laos' },
            { code: 'LB', name: 'Líbano' },
            { code: 'LC', name: 'Santa Lucía' },
            { code: 'LI', name: 'Liechtenstein' },
            { code: 'LK', name: 'Sri Lanka' },
            { code: 'LR', name: 'Liberia' },
            { code: 'LS', name: 'Lesoto' },
            { code: 'LT', name: 'Lituania' },
            { code: 'LU', name: 'Luxemburgo' },
            { code: 'LV', name: 'Letonia' },
            { code: 'LY', name: 'Libia' },
            { code: 'MA', name: 'Marruecos' },
            { code: 'MC', name: 'Mónaco' },
            { code: 'MD', name: 'Moldavia' },
            { code: 'ME', name: 'Montenegro' },
            { code: 'MF', name: 'San Martín' },
            { code: 'MG', name: 'Madagascar' },
            { code: 'MH', name: 'Islas Marshall' },
            { code: 'MK', name: 'Macedonia del Norte' },
            { code: 'ML', name: 'Mali' },
            { code: 'MM', name: 'Myanmar' },
            { code: 'MN', name: 'Mongolia' },
            { code: 'MO', name: 'Macao' },
            { code: 'MP', name: 'Islas Marianas del Norte' },
            { code: 'MQ', name: 'Martinica' },
            { code: 'MR', name: 'Mauritania' },
            { code: 'MS', name: 'Montserrat' },
            { code: 'MT', name: 'Malta' },
            { code: 'MU', name: 'Mauricio' },
            { code: 'MV', name: 'Maldivas' },
            { code: 'MW', name: 'Malawi' },
            { code: 'MX', name: 'México' },
            { code: 'MY', name: 'Malasia' },
            { code: 'MZ', name: 'Mozambique' },
            { code: 'NA', name: 'Namibia' },
            { code: 'NC', name: 'Nueva Caledonia' },
            { code: 'NE', name: 'Níger' },
            { code: 'NF', name: 'Isla Norfolk' },
            { code: 'NG', name: 'Nigeria' },
            { code: 'NI', name: 'Nicaragua' },
            { code: 'NL', name: 'Países Bajos' },
            { code: 'NO', name: 'Noruega' },
            { code: 'NP', name: 'Nepal' },
            { code: 'NR', name: 'Nauru' },
            { code: 'NU', name: 'Niue' },
            { code: 'NZ', name: 'Nueva Zelanda' },
            { code: 'OM', name: 'Omán' },
            { code: 'PA', name: 'Panamá' },
            { code: 'PE', name: 'Perú' },
            { code: 'PF', name: 'Polinesia Francesa' },
            { code: 'PG', name: 'Papúa Nueva Guinea' },
            { code: 'PH', name: 'Filipinas' },
            { code: 'PK', name: 'Pakistán' },
            { code: 'PL', name: 'Polonia' },
            { code: 'PM', name: 'San Pedro y Miquelón' },
            { code: 'PR', name: 'Puerto Rico' },
            { code: 'PS', name: 'Palestina' },
            { code: 'PT', name: 'Portugal' },
            { code: 'PY', name: 'Paraguay' },
            { code: 'QA', name: 'Qatar' },
            { code: 'RE', name: 'Reunión' },
            { code: 'RO', name: 'Rumanía' },
            { code: 'RS', name: 'Serbia' },
            { code: 'RU', name: 'Rusia' },
            { code: 'RW', name: 'Ruanda' },
            { code: 'SA', name: 'Arabia Saudí' },
            { code: 'SB', name: 'Islas Salomón' },
            { code: 'SC', name: 'Seychelles' },
            { code: 'SD', name: 'Sudán' },
            { code: 'SE', name: 'Suecia' },
            { code: 'SG', name: 'Singapur' },
            { code: 'SH', name: 'Santa Helena' },
            { code: 'SI', name: 'Eslovenia' },
            { code: 'SJ', name: 'Svalbard y Jan Mayen' },
            { code: 'SK', name: 'Eslovaquia' },
            { code: 'SL', name: 'Sierra Leona' },
            { code: 'SM', name: 'San Marino' },
            { code: 'SN', name: 'Senegal' },
            { code: 'SO', name: 'Somalia' },
            { code: 'SR', name: 'Surinam' },
            { code: 'SS', name: 'Sudán del Sur' },
            { code: 'ST', name: 'Santo Tomé y Príncipe' },
            { code: 'SV', name: 'El Salvador' },
            { code: 'SX', name: 'Sint Maarten' },
            { code: 'SY', name: 'Siria' },
            { code: 'SZ', name: 'Swazilandia' },
            { code: 'TC', name: 'Islas Turcas y Caicos' },
            { code: 'TD', name: 'Chad' },
            { code: 'TF', name: 'Territorio Austral Francés' },
            { code: 'TG', name: 'Togo' },
            { code: 'TH', name: 'Tailandia' },
            { code: 'TJ', name: 'Tayikistán' },
            { code: 'TK', name: 'Tokelau' },
            { code: 'TL', name: 'Timor Oriental' },
            { code: 'TM', name: 'Turkmenistán' },
            { code: 'TN', name: 'Túnez' },
            { code: 'TO', name: 'Tonga' },
            { code: 'TR', name: 'Turquía' },
            { code: 'TT', name: 'Trinidad y Tobago' },
            { code: 'TV', name: 'Tuvalu' },
            { code: 'TW', name: 'Taiwán' },
            { code: 'TZ', name: 'Tanzania' },
            { code: 'UA', name: 'Ucrania' },
            { code: 'UG', name: 'Uganda' },
            { code: 'UM', name: 'Islas menores alejadas de EE.UU.' },
            { code: 'US', name: 'Estados Unidos' },
            { code: 'UY', name: 'Uruguay' },
            { code: 'UZ', name: 'Uzbekistán' },
            { code: 'VA', name: 'Ciudad del Vaticano' },
            { code: 'VC', name: 'San Vicente y las Granadinas' },
            { code: 'VE', name: 'Venezuela' },
            { code: 'VG', name: 'Islas Vírgenes Británicas' },
            { code: 'VI', name: 'Islas Vírgenes de EE.UU.' },
            { code: 'VN', name: 'Vietnam' },
            { code: 'VU', name: 'Vanuatu' },
            { code: 'WF', name: 'Wallis y Futuna' },
            { code: 'WS', name: 'Samoa' },
            { code: 'YE', name: 'Yemen' },
            { code: 'YT', name: 'Mayotte' },
            { code: 'ZA', name: 'Sudáfrica' },
            { code: 'ZM', name: 'Zambia' },
            { code: 'ZW', name: 'Zimbabue' }
        ];
        // para el selector de destino
        function getColombiaPaisLabelByCode(code) {
            if (!code) return '';
            const item = colombiaPaisCatalog.find(c => c.code === String(code));
            return item ? `${item.name}` : code;
        }

        // Travel reasons
        const travelReasons = [
            { value: '1', labelKey: 'tourism' },
            { value: '2', labelKey: 'business' },
            { value: '3', labelKey: 'study' },
            { value: '4', labelKey: 'health' },
            { value: '5', labelKey: 'transit' },
            { value: '6', labelKey: 'family' },
            { value: '7', labelKey: 'work' },
            { value: '8', labelKey: 'other' }
        ];


        // Global state
        let state = {
            language: 'ES',
            reservationFound: false,
            guestName: '',
            guestSurname: '',
            foundReservationId: '',
            numGuests: 1,
            companions: [],
            guestFiles: [],
            companionFiles: {},
            captcha: '',
            userCaptcha: '',
            loading: false,
            formData: {
                idNumber: '',
                phone: '',
                email: '',
                birthDate: '',
                comments: '',
                country: '',
                state: '',
                city: '',
                residenceAddress: '',
                nationality: '',
                origin: '',
                destination: '',
                arrivalDateTime: '',
                residenceCity: '',
                travelReason: ''
            },
            countries: [],
            states: [],
            cities: [],
            loadingCountries: false,
            loadingStates: false,
            loadingCities: false
        };

        // Utility functions
        function getUrlParams() {
            const params = {};
            const urlParams = new URLSearchParams(window.location.search);
            for (const [key, value] of urlParams.entries()) {
                params[key] = value;
            }
            return params;
        }

        function getParam(key) {
            const params = getUrlParams();
            return params[key] || null;
        }

        // Extrae la porción numérica (más larga) de un reservationNumber ofuscado
        function extractReservationNumber(raw) {
            if (!raw || typeof raw !== 'string') return '';
            const matches = raw.match(/\d{6,}/g); // secuencias de 6+ dígitos
            if (!matches || matches.length === 0) return '';
            // Devolver la secuencia más larga (si hay varias, la primera de esas)
            matches.sort((a, b) => b.length - a.length);
            return matches[0];
        }

        function t(key) {
            return translations[state.language][key] || key;
        }

        function setLanguage(lang) {
            state.language = lang;
            document.documentElement.lang = lang.toLowerCase();
            render();
        }

        function showToast(title, message, type = 'success') {
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.innerHTML = `
                <div class="font-semibold">${title}</div>
                <div class="text-sm mt-1">${message}</div>
            `;
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.remove();
            }, 5000);
        }

        function generateCaptcha() {
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
            let result = '';
            for (let i = 0; i < 6; i++) {
                result += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            state.captcha = result;
            return result;
        }

        // API functions
        async function loadCountries() {
            if (state.loadingCountries || state.countries.length > 0) return;
            
            state.loadingCountries = true;
            render();
            
            try {
                // Usar directamente la API más confiable
                const response = await fetch('https://restcountries.com/v3.1/all?fields=name,cca2,cca3');
                const data = await response.json();
                
                if (data && Array.isArray(data) && data.length > 0) {
                    state.countries = data
                        .filter(country => country.name && country.cca2) // Filtrar países válidos
                        .map(country => ({
                            code: country.cca2,
                            name: country.name.common,
                            code3: country.cca3
                        }))
                        .sort((a, b) => a.name.localeCompare(b.name));
                    
                    console.log(`Loaded ${state.countries.length} countries successfully`);
                } else {
                    throw new Error('No countries data received');
                }
            } catch (error) {
                console.error('Error loading countries:', error);
                
                // Fallback con datos estáticos de países principales
                const fallbackCountries = [
                    { code: 'US', name: 'United States', code3: 'USA' },
                    { code: 'MX', name: 'Mexico', code3: 'MEX' },
                    { code: 'CA', name: 'Canada', code3: 'CAN' },
                    { code: 'ES', name: 'Spain', code3: 'ESP' },
                    { code: 'FR', name: 'France', code3: 'FRA' },
                    { code: 'DE', name: 'Germany', code3: 'DEU' },
                    { code: 'IT', name: 'Italy', code3: 'ITA' },
                    { code: 'GB', name: 'United Kingdom', code3: 'GBR' },
                    { code: 'BR', name: 'Brazil', code3: 'BRA' },
                    { code: 'AR', name: 'Argentina', code3: 'ARG' },
                    { code: 'CO', name: 'Colombia', code3: 'COL' },
                    { code: 'PE', name: 'Peru', code3: 'PER' },
                    { code: 'CL', name: 'Chile', code3: 'CHL' },
                    { code: 'VE', name: 'Venezuela', code3: 'VEN' },
                    { code: 'EC', name: 'Ecuador', code3: 'ECU' },
                    { code: 'BO', name: 'Bolivia', code3: 'BOL' },
                    { code: 'PY', name: 'Paraguay', code3: 'PRY' },
                    { code: 'UY', name: 'Uruguay', code3: 'URY' },
                    { code: 'GY', name: 'Guyana', code3: 'GUY' },
                    { code: 'SR', name: 'Suriname', code3: 'SUR' },
                    { code: 'JP', name: 'Japan', code3: 'JPN' },
                    { code: 'CN', name: 'China', code3: 'CHN' },
                    { code: 'IN', name: 'India', code3: 'IND' },
                    { code: 'AU', name: 'Australia', code3: 'AUS' },
                    { code: 'NZ', name: 'New Zealand', code3: 'NZL' },
                    { code: 'RU', name: 'Russia', code3: 'RUS' },
                    { code: 'KR', name: 'South Korea', code3: 'KOR' },
                    { code: 'NL', name: 'Netherlands', code3: 'NLD' },
                    { code: 'BE', name: 'Belgium', code3: 'BEL' },
                    { code: 'CH', name: 'Switzerland', code3: 'CHE' },
                    { code: 'AT', name: 'Austria', code3: 'AUT' },
                    { code: 'SE', name: 'Sweden', code3: 'SWE' },
                    { code: 'NO', name: 'Norway', code3: 'NOR' },
                    { code: 'DK', name: 'Denmark', code3: 'DNK' },
                    { code: 'FI', name: 'Finland', code3: 'FIN' },
                    { code: 'PL', name: 'Poland', code3: 'POL' },
                    { code: 'CZ', name: 'Czech Republic', code3: 'CZE' },
                    { code: 'HU', name: 'Hungary', code3: 'HUN' },
                    { code: 'RO', name: 'Romania', code3: 'ROU' },
                    { code: 'BG', name: 'Bulgaria', code3: 'BGR' },
                    { code: 'GR', name: 'Greece', code3: 'GRC' },
                    { code: 'PT', name: 'Portugal', code3: 'PRT' },
                    { code: 'IE', name: 'Ireland', code3: 'IRL' },
                    { code: 'IS', name: 'Iceland', code3: 'ISL' },
                    { code: 'LU', name: 'Luxembourg', code3: 'LUX' },
                    { code: 'MT', name: 'Malta', code3: 'MLT' },
                    { code: 'CY', name: 'Cyprus', code3: 'CYP' },
                    { code: 'HR', name: 'Croatia', code3: 'HRV' },
                    { code: 'SI', name: 'Slovenia', code3: 'SVN' },
                    { code: 'SK', name: 'Slovakia', code3: 'SVK' },
                    { code: 'EE', name: 'Estonia', code3: 'EST' },
                    { code: 'LV', name: 'Latvia', code3: 'LVL' },
                    { code: 'LT', name: 'Lithuania', code3: 'LTU' }
                ];
                
                state.countries = fallbackCountries.sort((a, b) => a.name.localeCompare(b.name));
                console.log(`Using fallback data: ${state.countries.length} countries`);
                showToast(t('warning'), 'Using fallback country data', 'warning');
            } finally {
                state.loadingCountries = false;
                render();
            }
        }

        async function loadStates(countryCode) {
            if (!countryCode || state.loadingStates) return;
            
            state.loadingStates = true;
            state.states = [];
            state.cities = [];
            state.formData.state = '';
            state.formData.city = '';
            render();

            try {
                const response = await fetch('https://countriesnow.space/api/v0.1/countries/states', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        country: state.countries.find(c => c.code === countryCode)?.name || countryCode
                    })
                });
                
                const data = await response.json();
                
                if (data.error === false && data.data.states) {
                    state.states = data.data.states
                        .map(state => ({ name: state.name }))
                        .sort((a, b) => a.name.localeCompare(b.name));
                }
            } catch (error) {
                console.error('Error loading states:', error);
                showToast(t('error'), 'Error loading states', 'error');
            } finally {
                state.loadingStates = false;
                render();
            }
        }

        function handleStateChange(stateValue) {
            state.formData.state = stateValue;
            
            if (stateValue) {
                const countryName = state.countries.find(c => c.code === state.formData.country)?.name;
                if (countryName) {
                    loadCities(countryName, stateValue);
                }
            } else {
                // Si no hay estado seleccionado, limpiar ciudades
                state.cities = [];
                state.formData.city = '';
                render();
            }
        }

        async function loadCities(countryName, stateName) {
            if (!countryName || !stateName || state.loadingCities) return;
            
            state.loadingCities = true;
            state.cities = [];
            state.formData.city = '';
            render();

            try {
                const response = await fetch('https://countriesnow.space/api/v0.1/countries/state/cities', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        country: countryName,
                        state: stateName
                    })
                });
                
                const data = await response.json();
                
                if (data.error === false && data.data) {
                    state.cities = data.data
                        .map(city => ({ name: city }))
                        .sort((a, b) => a.name.localeCompare(b.name));
                }
            } catch (error) {
                console.error('Error loading cities:', error);
                showToast(t('error'), 'Error loading cities', 'error');
            } finally {
                state.loadingCities = false;
                render();
            }
        }

        // Form validation
        function validateForm() {
            const requiredFields = ['idNumber', 'phone', 'email', 'birthDate'];
            
            for (const field of requiredFields) {
                if (!state.formData[field]) {
                    showToast(t('error'), t('fillRequiredFields'), 'error');
                    return false;
                }
            }

            // Location fields validation (if enabled)
            const showLocationFields = getParam('bitrixHotel') && getParam('bitrixKey');
            if (showLocationFields) {
                if (!state.formData.country || !state.formData.state || !state.formData.city) {
                    showToast(t('error'), t('fillLocationFields'), 'error');
                    return false;
                }
            }

            // Colombia fields validation (if enabled)
            const showColombiaFields = getParam('co') === 'true';
            if (showColombiaFields) {
                const colombiaFields = ['residenceAddress', 'nationality', 'origin', 'destination', 'arrivalDateTime', 'residenceCity', 'travelReason'];
                for (const field of colombiaFields) {
                    if (!state.formData[field]) {
                        showToast(t('error'), t('fillColombiaFields'), 'error');
                        return false;
                    }
                }
            }

            // Captcha validation
            if (state.userCaptcha !== state.captcha) {
                showToast(t('error'), t('invalidCaptcha'), 'error');
                return false;
            }

            return true;
        }

        // File handling
        function handleFileUpload(files, isCompanion = false, companionIndex = null) {
            const validTypes = ['image/jpeg', 'image/jpg', 'image/png', 'application/pdf'];
            const maxSize = 3 * 1024 * 1024; // 3MB
            
            const validFiles = [];
            
            for (const file of files) {
                if (!validTypes.includes(file.type)) {
                    showToast(t('error'), t('invalidFileType'), 'error');
                    continue;
                }
                
                if (file.size > maxSize) {
                    showToast(t('error'), t('fileTooLarge'), 'error');
                    continue;
                }
                
                validFiles.push(file);
            }
            
            if (isCompanion && companionIndex !== null) {
                if (!state.companionFiles[companionIndex]) {
                    state.companionFiles[companionIndex] = [];
                }
                state.companionFiles[companionIndex].push(...validFiles);
            } else {
                state.guestFiles.push(...validFiles);
            }
            
            render();
        }

        function removeFile(index, isCompanion = false, companionIndex = null) {
            if (isCompanion && companionIndex !== null) {
                state.companionFiles[companionIndex].splice(index, 1);
                if (state.companionFiles[companionIndex].length === 0) {
                    delete state.companionFiles[companionIndex];
                }
            } else {
                state.guestFiles.splice(index, 1);
            }
            render();
        }

        function convertToBase64(file) {
                return new Promise((resolve, reject) => {
                    const reader = new FileReader();
                    reader.readAsDataURL(file);
                    reader.onload = () => resolve(reader.result);
                    reader.onerror = error => reject(error);
                });
            }

        // Form submission
        async function handleSubmit(e) {
            e.preventDefault();
            
            if (!validateForm()) return;

            state.loading = true;
            render();

            try {
                // Convert files to base64 with metadata
                const guestDocuments = await Promise.all(
                    state.guestFiles.map(async (file, index) => {
                        const base64 = await convertToBase64(file);
                        const fileExtension = file.name.split('.').pop().toLowerCase();
                        
                        return {
                            rs_number: state.foundReservationId || '',
                            Doc_type: fileExtension,
                            Doc_value: base64,
                            Description: `Guest document ${index + 1} - ${file.name}`
                        };
                    })
                );
                
                const companionDocuments = {};
                for (const [index, files] of Object.entries(state.companionFiles)) {
                    companionDocuments[parseInt(index)] = await Promise.all(
                        files.map(async (file, fileIndex) => {
                            const base64 = await convertToBase64(file);
                            const fileExtension = file.name.split('.').pop().toLowerCase();
                            
                            return {
                                rs_number: state.foundReservationId || '',
                                Doc_type: fileExtension,
                                Doc_value: base64,
                                Description: `Companion ${parseInt(index) + 1} document ${fileIndex + 1} - ${file.name}`
                            };
                        })
                    );
                }

                // Prepare comments with Colombia data if applicable
                let finalComments = state.formData.comments;
                const showColombiaFields = getParam('co') === 'true';
                if (showColombiaFields) {
                    const isNumericCode = (val) => /^[0-9]+$/.test(String(val || ''));
                    const cityLabelOrEmpty = (val) => isNumericCode(val) ? getColombiaCityLabelByCode(val) : '';
                    const countryLabelOrEmpty = (val) => !isNumericCode(val) ? getColombiaPaisLabelByCode(val) : '';
                    const getTravelReasonText = (val) => {
                        const item = travelReasons.find(r => r.value === String(val));
                        return item ? `${val} - ${t(item.labelKey)}` : (val || '');
                    };

                    finalComments += '\n\n--- DATOS ADICIONALES DEL HUÉSPED PRINCIPAL ---\n';
                    finalComments += `Dirección de Residencia: ${state.formData.residenceAddress}\n`;
                    finalComments += `Nacionalidad: ${state.formData.nationality}\n`;
                    finalComments += `Procedencia: Ciudad de ${cityLabelOrEmpty(state.formData.origin)} - País: ${countryLabelOrEmpty(state.formData.origin)}\n`;
                    finalComments += `Destino: Ciudad de ${cityLabelOrEmpty(state.formData.destination)} - País: ${countryLabelOrEmpty(state.formData.destination)}\n`;
                    finalComments += `Fecha y Hora de Llegada: ${state.formData.arrivalDateTime}\n`;
                    finalComments += `Ciudad de Residencia: ${state.formData.residenceCity}\n`;
                    finalComments += `Motivo de Viaje: ${getTravelReasonText(state.formData.travelReason)}\n`;
                    
                    // Add companion additional data
                    if (state.companions.length > 0) {
                        state.companions.forEach((companion, index) => {
                            finalComments += `\n\n--- DATOS ADICIONALES DEL ACOMPAÑANTE ${index + 1} ---\n`;
                            finalComments += `Nombre: ${companion.name} ${companion.surname}\n`;
                            finalComments += `Dirección de Residencia: ${companion.residenceAddress || 'No especificado'}\n`;
                            finalComments += `Nacionalidad: ${companion.nationality || 'No especificado'}\n`;
                            finalComments += `Procedencia: Ciudad de ${cityLabelOrEmpty(companion.origin)} - País: ${countryLabelOrEmpty(companion.origin)}\n`;
                            finalComments += `Destino: Ciudad de ${cityLabelOrEmpty(companion.destination)} - País: ${countryLabelOrEmpty(companion.destination)}\n`;
                            finalComments += `Fecha y Hora de Llegada: ${companion.arrivalDateTime || 'No especificado'}\n`;
                            finalComments += `Ciudad de Residencia: ${companion.residenceCity || 'No especificado'}\n`;
                            finalComments += `Motivo de Viaje: ${companion.travelReason ? getTravelReasonText(companion.travelReason) : 'No especificado'}\n`;
                        });
                    }
                }

                const submitData = {
                    ...state.formData,
                    comments: finalComments,
                    birthDate: new Date(state.formData.birthDate).toISOString(),
                    guests: state.companions.map((companion, index) => ({
                        ...companion,
                        birthDate: new Date(companion.birthDate).toISOString(),
                        documents: companionDocuments[index] || []
                    })),
                    documents: guestDocuments,
                    hotelID: getParam('hotelID') || '',
                    status: 'submitted',
                    bitrixHotel: getParam('bitrixHotel'),
                    bitrixKey: getParam('bitrixKey'),
                    reservationNumber: state.foundReservationId
                };

                const response = await fetch('https://automate.golobby.ai/webhook/c50c0efe-49c8-4161-96d9-c3958676a95f', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(submitData)
                });

                if (response.ok) {
                    // Parse the response to get redirect URL
                    const responseData = await response.json();
                    
                    showToast(t('success'), t('checkinSuccess'), 'success');

                    // Reset form
                    state.formData = {
                        idNumber: '',
                        phone: '',
                        email: '',
                        birthDate: '',
                        comments: '',
                        country: '',
                        state: '',
                        city: '',
                        residenceAddress: '',
                        nationality: '',
                        origin: '',
                        destination: '',
                        arrivalDateTime: '',
                        residenceCity: '',
                        travelReason: ''
                    };
                    state.companions = [];
                    state.guestFiles = [];
                    state.companionFiles = {};
                    state.userCaptcha = '';
                    generateCaptcha();

                    // Handle redirection based on webhook response
                    let redirectUrl = null;
                    
                    // Helper function to validate URL
                    const isValidUrl = (url) => {
                        return url && 
                               typeof url === 'string' && 
                               url.trim() !== '' && 
                               url !== 'undefined' && 
                               url !== 'null' && 
                               url.toLowerCase() !== 'undefined' &&
                               url.toLowerCase() !== 'null';
                    };
                    
                    // First priority: URL from webhook response
                    if (responseData && isValidUrl(responseData.redirectUrl)) {
                        redirectUrl = responseData.redirectUrl;
                    }
                    // Second priority: URL from webhook response (alternative field names)
                    else if (responseData && isValidUrl(responseData.redirect_url)) {
                        redirectUrl = responseData.redirect_url;
                    }
                    else if (responseData && isValidUrl(responseData.url)) {
                        redirectUrl = responseData.url;
                    }

                    // Perform redirect if URL is available
                    if (redirectUrl) {
                        setTimeout(() => {
                            window.location.href = redirectUrl;
                        }, 2000);
                    }
                } else {
                    throw new Error('Submission failed');
                }
            } catch (error) {
                showToast(t('error'), t('submitError'), 'error');
            } finally {
                state.loading = false;
                render();
            }
        }

        // Reservation search
        async function searchReservation() {
            const reservationNumber = document.getElementById('reservationNumberInput').value;
            if (!reservationNumber) return;

            state.loading = true;
            render();

            try {
                const cleanedReservationNumber = extractReservationNumber(reservationNumber) || reservationNumber;
                const response = await fetch('https://automate.golobby.ai/webhook/c50c0efe-49c8-4161-96d9-c3958676a95f', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        reservationNumber: cleanedReservationNumber,
                        GetReservationKey: true,
                        hotelID: getParam('hotelID') || ''
                    })
                });

                if (response.ok) {
                    const data = await response.json();
                    state.reservationFound = true;
                    state.guestName = data.guestName || '';
                    state.guestSurname = data.guestSurname || '';
                    state.foundReservationId = data.reservationId || cleanedReservationNumber;
                    
                    if (data.guest && parseInt(data.guest) > 1) {
                        const guestCount = parseInt(data.guest);
                        state.numGuests = guestCount;
                                            state.companions = Array(guestCount - 1).fill(null).map(() => ({
                        name: '',
                        surname: '',
                        idNumber: '',
                        phone: '',
                        email: '',
                        birthDate: '',
                        country: '',
                        state: '',
                        city: '',
                        residenceAddress: '',
                        nationality: '',
                        origin: '',
                        destination: '',
                        arrivalDateTime: '',
                        residenceCity: '',
                        travelReason: ''
                    }));
                    }
                } else {
                    showToast(t('error'), t('reservationNotFound'), 'error');
                }
                } catch (error) {
                showToast(t('error'), t('reservationNotFound'), 'error');
            } finally {
                state.loading = false;
                render();
            }
        }

        // Companion management
        function addCompanion() {
            state.companions.push({
                name: '',
                surname: '',
                idNumber: '',
                phone: '',
                email: '',
                birthDate: '',
                country: '',
                state: '',
                city: '',
                residenceAddress: '',
                nationality: '',
                origin: '',
                destination: '',
                arrivalDateTime: '',
                residenceCity: '',
                travelReason: ''
            });
            state.numGuests = state.companions.length + 1;
            render();
        }

        function removeCompanion(index) {
            state.companions.splice(index, 1);
            state.numGuests = state.companions.length + 1;
            
            // Remove companion files
            if (state.companionFiles[index]) {
                delete state.companionFiles[index];
            }
            
            // Reindex companion files
            const newCompanionFiles = {};
            Object.entries(state.companionFiles).forEach(([oldIndex, files]) => {
                const newIndex = parseInt(oldIndex) > index ? parseInt(oldIndex) - 1 : parseInt(oldIndex);
                newCompanionFiles[newIndex] = files;
            });
            state.companionFiles = newCompanionFiles;
            
            render();
        }

        // Render functions
        function renderReservationSearch() {
            return `
                <div class="min-h-screen" style="background-color: hsl(var(--background));">
                    <div class="container py-8">
                        <div class="max-w-2xl mx-auto">
                            <div class="text-center mb-8">
                                <h1 class="text-3xl font-bold mb-2" style="color: hsl(var(--foreground));">${t('hotelCheckin')}</h1>
                                <p style="color: hsl(var(--muted-foreground));">${t('searchReservation')}</p>
                            </div>
                            
                            <div class="hotel-card fade-in">
                                <div class="space-y-4">
                                    <div>
                                        <label class="hotel-label">${t('reservationNumber')}</label>
                                        <input 
                                            type="text" 
                                            id="reservationNumberInput"
                                            class="hotel-input" 
                                            placeholder="${t('enterReservationNumber')}"
                                        />
                                    </div>
                                    <div class="text-center">
                                        <button 
                                            type="button" 
                                            class="hotel-button-primary px-8 py-4"
                                            ${state.loading ? 'disabled' : ''}
                                            onclick="searchReservation()"
                                        >
                                            ${state.loading ? t('searching') : t('searchReservationBtn')}
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderLanguageSelector() {
            return `
                <div class="flex justify-end mb-6">
                    <div class="flex space-x-2">
                        ${['ES', 'EN', 'PT'].map(lang => `
                            <button
                                class="language-btn ${state.language === lang ? 'active' : ''}"
                                onclick="setLanguage('${lang}')"
                            >
                                ${lang}
                            </button>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        function renderGuestForm() {
            return `
                <div class="hotel-card fade-in">
                    <div class="flex items-center space-x-2 mb-6">
                        <svg class="icon text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"></path>
                        </svg>
                        <h2 class="text-xl font-semibold">${t('mainGuestData')}</h2>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="hotel-label">${t('idNumber')} *</label>
                            <input 
                                type="text" 
                                class="hotel-input" 
                                placeholder="${t('enterIdNumber')}"
                                value="${state.formData.idNumber}"
                                onchange="state.formData.idNumber = this.value"
                            />
                        </div>
                        <div>
                            <label class="hotel-label">${t('phone')} *</label>
                            <input 
                                type="tel" 
                                class="hotel-input" 
                                placeholder="${t('enterPhone')}"
                                value="${state.formData.phone}"
                                onchange="state.formData.phone = this.value"
                            />
                        </div>
                        <div>
                            <label class="hotel-label">${t('email')} *</label>
                            <input 
                                type="email" 
                                class="hotel-input" 
                                placeholder="${t('enterEmail')}"
                                value="${state.formData.email}"
                                onchange="state.formData.email = this.value"
                            />
                        </div>
                        <div>
                            <label class="hotel-label">${t('birthDate')} *</label>
                            <input 
                                type="date" 
                                class="hotel-input"
                                min="1900-01-01"
                                max="${new Date().toISOString().split('T')[0]}"
                                value="${state.formData.birthDate}"
                                onchange="state.formData.birthDate = this.value"
                            />
                        </div>
                        <div class="md:col-span-2">
                            <label class="hotel-label">${t('comments')}</label>
                            <textarea 
                                class="hotel-input" 
                                rows="3"
                                placeholder="${t('enterComments')}"
                                onchange="state.formData.comments = this.value"
                            >${state.formData.comments}</textarea>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderLocationFields() {
            const showLocationFields = getParam('bitrixHotel') && getParam('bitrixKey');
            if (!showLocationFields) return '';

            if (state.countries.length === 0 && !state.loadingCountries) {
                loadCountries();
            }

            return `
                <div class="hotel-card slide-up">
                    <div class="flex items-center space-x-2 mb-6">
                        <svg class="icon text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path>
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path>
                        </svg>
                        <h2 class="text-xl font-semibold">${t('locationData')}</h2>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div>
                            <label class="hotel-label">${t('country')} *</label>
                            <select 
                                class="hotel-select"
                                value="${state.formData.country}"
                                onchange="state.formData.country = this.value; if(this.value) loadStates(this.value);"
                            >
                                <option value="">${state.loadingCountries ? t('loadingCountries') : t('selectCountry')}</option>
                                ${state.countries.map(country => `
                                    <option value="${country.code}" ${state.formData.country === country.code ? 'selected' : ''}>
                                        ${country.name}
                                    </option>
                                `).join('')}
                            </select>
                        </div>
                        <div>
                            <label class="hotel-label">${t('state')} *</label>
                            <select 
                                class="hotel-select"
                                value="${state.formData.state}"
                                onchange="handleStateChange(this.value)"
                                ${!state.formData.country ? 'disabled' : ''}
                            >
                                <option value="">${state.loadingStates ? t('loadingStates') : (!state.formData.country ? t('selectCountry') : t('selectState'))}</option>
                                ${state.states.map(stateItem => `
                                    <option value="${stateItem.name}" ${state.formData.state === stateItem.name ? 'selected' : ''}>
                                        ${stateItem.name}
                                    </option>
                                `).join('')}
                            </select>
                        </div>
                        <div>
                            <label class="hotel-label">${t('city')} *</label>
                            <select 
                                class="hotel-select"
                                value="${state.formData.city}"
                                onchange="state.formData.city = this.value"
                                ${!state.formData.state ? 'disabled' : ''}
                            >
                                <option value="">${state.loadingCities ? t('loadingCities') : (!state.formData.state ? t('selectState') : t('selectCity'))}</option>
                                ${state.cities.map(city => `
                                    <option value="${city.name}" ${state.formData.city === city.name ? 'selected' : ''}>
                                        ${city.name}
                                    </option>
                                `).join('')}
                            </select>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderColombiaFields() {
            const showColombiaFields = getParam('co') === 'true';
            if (!showColombiaFields) return '';

            return `
                <div class="hotel-card slide-up">
                    <div class="flex items-center space-x-2 mb-6">
                        <svg class="icon text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                        <h2 class="text-xl font-semibold">${t('additionalData')}</h2>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="hotel-label">${t('residenceAddress')} *</label>
                            <input 
                                type="text" 
                                class="hotel-input" 
                                placeholder="${t('enterAddress')}"
                                value="${state.formData.residenceAddress}"
                                onchange="state.formData.residenceAddress = this.value"
                            />
                        </div>
                        <div>
                            <label class="hotel-label">${t('nationality')} *</label>
                            <input 
                                type="text" 
                                class="hotel-input" 
                                placeholder="${t('enterNationality')}"
                                value="${state.formData.nationality}"
                                onchange="state.formData.nationality = this.value"
                            />
                        </div>
                        <div>
                            <label class="hotel-label">${t('origin')} *</label>
                            <div class="flex items-center space-x-2">
                            <select 
                                class="hotel-select"
                                value="${state.formData.origin}"
                                onchange="handleOriginChange(this.value)"
                                ${state.formData.origin && colombiaPaisCatalog.find(c => c.code === state.formData.origin) ? 'disabled' : ''}
                            >
                                <option value="">${t('selectCity')}</option>
                                ${colombiaCityCatalog
                                    .slice()
                                    .sort((a,b) => a.name.localeCompare(b.name, 'es'))
                                    .map(({code, name}) => `
                                        <option value="${code}" ${state.formData.origin === code ? 'selected' : ''}>
                                            ${getColombiaCityLabelByCode(code)}
                                        </option>
                                    `).join('')}
                            </select>
                            <select 
                                class="hotel-select"
                                value="${state.formData.origin}"
                                onchange="handleOriginChange(this.value)"
                                ${state.formData.origin && colombiaCityCatalog.find(c => c.code === state.formData.origin) ? 'disabled' : ''}
                            >
                                <option value="">${t('selectCountry')}</option>
                                ${colombiaPaisCatalog
                                    .slice()
                                    .sort((a,b) => a.name.localeCompare(b.name, 'es'))
                                    .map(({code, name}) => `
                                        <option value="${code}" ${state.formData.origin === code ? 'selected' : ''}>
                                            ${getColombiaPaisLabelByCode(code)}
                                        </option>
                                    `).join('')}
                            </select>
                            </div>
                        </div>
                        <div>
                            <label class="hotel-label">${t('destination')} *</label>
                            <div class="flex items-center space-x-2">
                            <select 
                                class="hotel-select"
                                value="${state.formData.destination}"
                                onchange="handleDestinationChange(this.value)"
                                ${state.formData.destination && colombiaPaisCatalog.find(c => c.code === state.formData.destination) ? 'disabled' : ''}
                            >
                                <option value="">${t('selectCity')}</option>
                                ${colombiaCityCatalog
                                    .slice()
                                    .sort((a,b) => a.name.localeCompare(b.name, 'es'))
                                    .map(({code, name}) => `
                                        <option value="${code}" ${state.formData.destination === code ? 'selected' : ''}>
                                            ${getColombiaCityLabelByCode(code)}
                                        </option>
                                    `).join('')}
                            </select>
                            <select 
                                class="hotel-select"
                                value="${state.formData.destination}"
                                onchange="handleDestinationChange(this.value)"
                                ${state.formData.destination && colombiaCityCatalog.find(c => c.code === state.formData.destination) ? 'disabled' : ''}
                            >
                                <option value="">${t('selectCountry')}</option>
                                ${colombiaPaisCatalog
                                    .slice()
                                    .sort((a,b) => a.name.localeCompare(b.name, 'es'))
                                    .map(({code, name}) => `
                                        <option value="${code}" ${state.formData.destination === code ? 'selected' : ''}>
                                            ${getColombiaPaisLabelByCode(code)}
                                    </option>
                                `).join('')}
                            </select>
                            </div>
                        </div>
                        <div>
                            <label class="hotel-label">${t('arrivalDateTime')} *</label>
                            <input 
                                type="datetime-local" 
                                class="hotel-input"
                                value="${state.formData.arrivalDateTime}"
                                onchange="state.formData.arrivalDateTime = this.value"
                            />
                        </div>
                        <div>
                            <label class="hotel-label">${t('residenceCity')} *</label>
                            <input 
                                type="text" 
                                class="hotel-input" 
                                placeholder="${t('enterResidenceCity')}"
                                value="${state.formData.residenceCity}"
                                onchange="state.formData.residenceCity = this.value"
                            />
                        </div>
                        <div class="md:col-span-2">
                            <label class="hotel-label">${t('travelReason')} *</label>
                            <select 
                                class="hotel-select"
                                value="${state.formData.travelReason}"
                                onchange="state.formData.travelReason = this.value"
                            >
                                <option value="">${t('selectReason')}</option>
                                ${travelReasons.map(reason => `
                                    <option value="${reason.value}" ${state.formData.travelReason === reason.value ? 'selected' : ''}>
                                        ${t(reason.labelKey)}
                                    </option>
                                `).join('')}
                            </select>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderFileUpload(files, title, isCompanion = false, companionIndex = null) {
            const uploadId = isCompanion ? `fileUpload_${companionIndex}` : 'guestFileUpload';
            
            return `
                <div class="hotel-card slide-up">
                    <div class="flex items-center space-x-2 mb-6">
                        <svg class="icon text-primary" fill="none" stroke="currentColor" viewBox="0 0 22 22">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path>
                        </svg>
                        <h2 class="text-xl font-semibold">${title}</h2>
                    </div>
                    
                    <div 
                        class="file-upload-zone"
                        onclick="document.getElementById('${uploadId}').click()"
                        ondrop="handleDrop(event, ${isCompanion}, ${companionIndex})"
                        ondragover="handleDragOver(event)"
                        ondragleave="handleDragLeave(event)"
                    >
                        <svg class="w-12 h-12 mx-auto mb-4 text-muted-foreground" fill="none" stroke="currentColor" viewBox="-12 0 48 25">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path>
                        </svg>
                        <p class="mb-2 font-medium">${t('dragDropFiles')}</p>
                        <p class="text-sm text-muted-foreground">${t('supportedFormats')}</p>
                    </div>
                    
                    <input 
                        type="file" 
                        id="${uploadId}"
                        multiple 
                        accept=".jpg,.jpeg,.png,.pdf"
                        class="hidden"
                        onchange="handleFileChange(event, ${isCompanion}, ${companionIndex})"
                    />
                    
                    ${files.length > 0 ? `
                        <div class="file-list">
                            <h3 class="font-medium mb-2">${t('uploadedFiles')}</h3>
                            ${files.map((file, index) => `
                                <div class="file-item">
                                    <div>
                                        <span class="font-medium">${file.name}</span>
                                        <span class="text-sm text-muted-foreground ml-2">(${(file.size / 1024 / 1024).toFixed(2)} MB)</span>
                                    </div>
                                    <button 
                                        type="button" 
                                        class="text-destructive hover:opacity-75"
                                        onclick="removeFile(${index}, ${isCompanion}, ${companionIndex})"
                                    >
                                        ${t('removeFile')}
                                    </button>
                                </div>
                            `).join('')}
                        </div>
                    ` : ''}
                </div>
            `;
        }

        function renderCompanions() {
            return `
                <div class="hotel-card slide-up">
                    <div class="flex flex-col justify-between mb-6">
                        <div class="flex items-center space-x-2">
                            <svg class="icon text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path>
                            </svg>
                            <h2 class="text-xl font-semibold">${t('companions')}</h2>
                        </div>
                        <button 
                            type="button" 
                            class="hotel-button-primary"
                            onclick="addCompanion()"
                        >
                            ${t('addCompanion')}
                        </button>
                    </div>
                    
                    <div class="space-y-4">
                        <div>
                            <label class="hotel-label">${t('numGuests')}</label>
                            <input 
                                type="number" 
                                class="hotel-input" 
                                min="1"
                                value="${state.numGuests}"
                                onchange="updateNumGuests(parseInt(this.value))"
                            />
                    </div>
                        
                        ${state.companions.length === 0 ? `
                            <p class="text-muted-foreground text-center py-8">${t('noCompanions')}</p>
                        ` : state.companions.map((companion, index) => `
                            <div class="companion-section">
                                <div class="flex items-center justify-between mb-4">
                                    <h3 class="font-semibold">${t('companionData')} ${index + 1}</h3>
                                    <button 
                                        type="button" 
                                        class="remove-companion-btn"
                                        onclick="removeCompanion(${index})"
                                    >
                                        ${t('removeCompanion')}
                                    </button>
                    </div>
                                
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                                    <div>
                                        <label class="hotel-label">${t('name')} *</label>
                                        <input 
                                            type="text" 
                                            class="hotel-input"
                                            value="${companion.name}"
                                            onchange="state.companions[${index}].name = this.value"
                                        />
                    </div>
                                    <div>
                                        <label class="hotel-label">${t('surname')} *</label>
                                        <input 
                                            type="text" 
                                            class="hotel-input"
                                            value="${companion.surname}"
                                            onchange="state.companions[${index}].surname = this.value"
                                        />
                    </div>
                                    <div>
                                        <label class="hotel-label">${t('idNumber')} *</label>
                                        <input 
                                            type="text" 
                                            class="hotel-input"
                                            value="${companion.idNumber}"
                                            onchange="state.companions[${index}].idNumber = this.value"
                                        />
                    </div>
                                    <div>
                                        <label class="hotel-label">${t('phone')} *</label>
                                        <input 
                                            type="tel" 
                                            class="hotel-input"
                                            value="${companion.phone}"
                                            onchange="state.companions[${index}].phone = this.value"
                                        />
                                    </div>
                                    <div>
                                        <label class="hotel-label">${t('email')} *</label>
                                        <input 
                                            type="email" 
                                            class="hotel-input"
                                            value="${companion.email}"
                                            onchange="state.companions[${index}].email = this.value"
                                        />
                                    </div>
                                    <div>
                                        <label class="hotel-label">${t('birthDate')} *</label>
                                        <input 
                                            type="date" 
                                            class="hotel-input"
                                            min="1900-01-01"
                                            max="${new Date().toISOString().split('T')[0]}"
                                            value="${companion.birthDate}"
                                            onchange="state.companions[${index}].birthDate = this.value"
                                        />
                                    </div>
                                </div>
                                
                                ${getParam('co') === 'true' ? `
                                <div class="companion-additional-data">
                                    <h4 class="font-medium mb-3 text-primary">${t('additionalData')}</h4>
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                                        <div>
                                            <label class="hotel-label">${t('residenceAddress')} *</label>
                                            <input 
                                                type="text" 
                                                class="hotel-input" 
                                                placeholder="${t('enterAddress')}"
                                                value="${companion.residenceAddress || ''}"
                                                onchange="state.companions[${index}].residenceAddress = this.value"
                                            />
                                        </div>
                                        <div>
                                            <label class="hotel-label">${t('nationality')} *</label>
                                            <input 
                                                type="text" 
                                                class="hotel-input" 
                                                placeholder="${t('enterNationality')}"
                                                value="${companion.nationality || ''}"
                                                onchange="state.companions[${index}].nationality = this.value"
                                            />
                                        </div>
                                        <div>
                                            <label class="hotel-label">${t('origin')} *</label>
                                            <div class="flex items-center space-x-2">
                                                <select 
                                                    class="hotel-input"
                                                    onchange="updateCompanionOriginCity(${index}, this.value)"
                                                    ${companion.origin && colombiaPaisCatalog.find(c => c.code === companion.origin) ? 'disabled' : ''}
                                                >
                                                    <option value="">${t('selectCity')}</option>
                                                    ${colombiaCityCatalog.map(city => `
                                                        <option value="${city.code}" ${companion.origin === city.code ? 'selected' : ''}>
                                                            ${city.name}
                                                        </option>
                                                    `).join('')}
                                                </select>

                                                <select 
                                                    class="hotel-input"
                                                    onchange="updateCompanionOriginCountry(${index}, this.value)"
                                                    ${companion.origin && colombiaCityCatalog.find(c => c.code === companion.origin) ? 'disabled' : ''}
                                                >
                                                    <option value="">${t('selectCountry')}</option>
                                                    ${colombiaPaisCatalog.map(country => `
                                                        <option value="${country.code}" ${companion.origin === country.code ? 'selected' : ''}>
                                                            ${country.name}
                                                        </option>
                                                    `).join('')}
                                                </select>
                                            </div>
                                        </div>
                                        <div>
                                            <label class="hotel-label">${t('destination')} *</label>
                                            <div class="flex items-center space-x-2">
                                                <select 
                                                    class="hotel-input"
                                                    onchange="updateCompanionDestinationCity(${index}, this.value)"
                                                    ${companion.destination && colombiaPaisCatalog.find(c => c.code === companion.destination) ? 'disabled' : ''}
                                                >
                                                    <option value="">${t('selectCity')}</option>
                                                    ${colombiaCityCatalog.map(city => `
                                                        <option value="${city.code}" ${companion.destination === city.code ? 'selected' : ''}>
                                                            ${city.name}
                                                        </option>
                                                    `).join('')}
                                                </select>
                                                <select 
                                                    class="hotel-input"
                                                    onchange="updateCompanionDestinationCountry(${index}, this.value)"
                                                    ${companion.destination && colombiaCityCatalog.find(c => c.code === companion.destination) ? 'disabled' : ''}
                                                >
                                                    <option value="">${t('selectCountry')}</option>
                                                    ${colombiaPaisCatalog.map(country => `
                                                        <option value="${country.code}" ${companion.destination === country.code ? 'selected' : ''}>
                                                            ${country.name}
                                                        </option>
                                                    `).join('')}
                                                </select>
                                            </div>
                                        </div>
                                        <div>
                                            <label class="hotel-label">${t('arrivalDateTime')} *</label>
                                            <input 
                                                type="datetime-local" 
                                                class="hotel-input"
                                                value="${companion.arrivalDateTime || ''}"
                                                onchange="state.companions[${index}].arrivalDateTime = this.value"
                                            />
                                        </div>
                                        <div>
                                            <label class="hotel-label">${t('residenceCity')} *</label>
                                            <input 
                                                type="text" 
                                                class="hotel-input" 
                                                placeholder="${t('enterResidenceCity')}"
                                                value="${companion.residenceCity || ''}"
                                                onchange="state.companions[${index}].residenceCity = this.value"
                                            />
                                        </div>
                                        <div class="md:col-span-2">
                                            <label class="hotel-label">${t('travelReason')} *</label>
                                            <select 
                                                class="hotel-input"
                                                onchange="state.companions[${index}].travelReason = this.value"
                                            >
                                                <option value="">${t('selectReason')}</option>
                                                <option value="1" ${companion.travelReason === '1' ? 'selected' : ''}>1 - ${t('tourism')}</option>
                                                <option value="2" ${companion.travelReason === '2' ? 'selected' : ''}>2 - ${t('family')}</option>
                                                <option value="3" ${companion.travelReason === '3' ? 'selected' : ''}>3 - ${t('study')}</option>
                                                <option value="4" ${companion.travelReason === '4' ? 'selected' : ''}>4 - ${t('health')}</option>
                                                <option value="5" ${companion.travelReason === '5' ? 'selected' : ''}>5 - ${t('religion')}</option>
                                                <option value="6" ${companion.travelReason === '6' ? 'selected' : ''}>6 - ${t('shopping')}</option>
                                                <option value="7" ${companion.travelReason === '7' ? 'selected' : ''}>7 - ${t('transit')}</option>
                                                <option value="8" ${companion.travelReason === '8' ? 'selected' : ''}>8 - ${t('other')}</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                ` : ''}
                                
                                ${renderFileUpload(state.companionFiles[index] || [], t('uploadDocuments'), true, index)}
                            </div>
                        `).join('')}
                            </div>
                            </div>
            `;
        }

        function renderCaptcha() {
            return `
                <div class="hotel-card slide-up">
                    <div class="flex items-center space-x-2 mb-6">
                        <svg class="icon text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"></path>
                        </svg>
                        <h2 class="text-xl font-semibold">${t('security')}</h2>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 items-end">
                        <div>
                            <label class="hotel-label">${t('captchaCode')}</label>
                            <div class="captcha-display">${state.captcha}</div>
                        </div>
                        <div>
                            <label class="hotel-label">${t('enterCaptcha')} *</label>
                            <div class="flex space-x-2">
                                <input 
                                    type="text" 
                                    class="hotel-input"
                                    value="${state.userCaptcha}"
                                    onchange="state.userCaptcha = this.value"
                                    placeholder="${t('enterCaptcha')}"
                                />
                                <button 
                                    type="button" 
                                    class="hotel-button-primary"
                                    onclick="generateCaptcha(); render();"
                                >
                                    ${t('regenerateCaptcha')}
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderMainForm() {
            return `
                <div class="min-h-screen" style="background-color: hsl(var(--background));">
                    <div class="container py-8">
                        <div class="max-w-4xl mx-auto">
                            <!-- Header -->
                            <div class="text-center mb-8">
                                <h1 class="text-3xl font-bold mb-2" style="color: hsl(var(--foreground));">${t('checkinForm')}</h1>
                                <p style="color: hsl(var(--muted-foreground));">
                                    ${t('welcome')} ${state.guestName} ${state.guestSurname}
                                </p>
                            </div>

                            ${renderLanguageSelector()}

                            <form onsubmit="handleSubmit(event)" class="space-y-6">
                                ${renderGuestForm()}
                                ${renderLocationFields()}
                                ${renderColombiaFields()}
                                ${renderCompanions()}
                                ${renderFileUpload(state.guestFiles, t('uploadDocuments'))}
                                ${renderCaptcha()}

                                <!-- Submit Button -->
                                <div class="flex justify-center">
                                    <button
                                        type="submit"
                                        class="hotel-button-primary px-8 py-4 text-lg min-w-200"
                                        ${state.loading ? 'disabled' : ''}
                                    >
                                        ${state.loading ? t('submitting') : t('submitCheckin')}
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            `;
        }

        // Event handlers
        function handleFileChange(event, isCompanion = false, companionIndex = null) {
            const files = Array.from(event.target.files);
            handleFileUpload(files, isCompanion, companionIndex);
            event.target.value = ''; // Reset input
        }

        function handleDragOver(event) {
            event.preventDefault();
            event.currentTarget.classList.add('drag-over');
        }

        function handleDragLeave(event) {
            event.preventDefault();
            event.currentTarget.classList.remove('drag-over');
        }

        function handleDrop(event, isCompanion = false, companionIndex = null) {
            event.preventDefault();
            event.currentTarget.classList.remove('drag-over');
            const files = Array.from(event.dataTransfer.files);
            handleFileUpload(files, isCompanion, companionIndex);
        }

        function handleOriginChange(value) {
            state.formData.origin = value;
            render();
        }

        function handleDestinationChange(value) {
            state.formData.destination = value;
            render();
        }

        function updateCompanionOriginCity(index, value) {
            state.companions[index].origin = value;
            render();
        }

        function updateCompanionOriginCountry(index, value) {
            state.companions[index].origin = value;
            render();
        }

        function updateCompanionDestinationCity(index, value) {
            state.companions[index].destination = value;
            render();
        }

        function updateCompanionDestinationCountry(index, value) {
            state.companions[index].destination = value;
            render();
        }

        function updateNumGuests(num) {
            if (num < 1) return;
            
            state.numGuests = num;
            const companionsNeeded = num - 1;
            
            if (companionsNeeded > state.companions.length) {
                // Add companions
                const toAdd = companionsNeeded - state.companions.length;
                for (let i = 0; i < toAdd; i++) {
                    state.companions.push({
                        name: '',
                        surname: '',
                        idNumber: '',
                        phone: '',
                        email: '',
                        birthDate: '',
                        country: '',
                        state: '',
                        city: '',
                        residenceAddress: '',
                        nationality: '',
                        origin: '',
                        destination: '',
                        arrivalDateTime: '',
                        residenceCity: '',
                        travelReason: ''
                    });
                }
            } else if (companionsNeeded < state.companions.length) {
                // Remove companions
                const toRemove = state.companions.length - companionsNeeded;
                for (let i = 0; i < toRemove; i++) {
                    const removedIndex = state.companions.length - 1;
                    state.companions.pop();
                    
                    // Remove companion files
                    if (state.companionFiles[removedIndex]) {
                        delete state.companionFiles[removedIndex];
                    }
                }
            }
            
            render();
        }

        // Main render function
        function render() {
            const app = document.getElementById('app');
            if (state.reservationFound) {
                app.innerHTML = renderMainForm();
            } else {
                app.innerHTML = renderReservationSearch();
            }
        }

        // Initialize application
        function init() {
            // Initialize from URL parameters
            const urlLanguage = getParam('language');
            if (urlLanguage && ['ES', 'EN', 'PT'].includes(urlLanguage)) {
                state.language = urlLanguage;
                document.documentElement.lang = urlLanguage.toLowerCase();
            }

            // Pre-fill if reservation data is in URL
            const hotelID = getParam('hotelID');
            const reservationNumber = getParam('reservationNumber');
            const guest = getParam('guest');
            const co = getParam('co');
            const urlGuestName = getParam('guestName');
            const urlGuestSurname = getParam('guestSurname');

            // Check if we have reservation data from URL parameters
            if (hotelID && reservationNumber && guest) {
                state.reservationFound = true;
                const cleanedReservationNumber = extractReservationNumber(reservationNumber) || reservationNumber;
                state.foundReservationId = cleanedReservationNumber;
                
                // Set guest name and surname if provided
                if (urlGuestName) {
                    state.guestName = urlGuestName;
                }
                if (urlGuestSurname) {
                    state.guestSurname = urlGuestSurname;
                }
                
                const guestCount = parseInt(guest);
                if (guestCount > 1) {
                    state.numGuests = guestCount;
                    state.companions = Array(guestCount - 1).fill(null).map(() => ({
                        name: '',
                        surname: '',
                        idNumber: '',
                        phone: '',
                        email: '',
                        birthDate: '',
                        country: '',
                        state: '',
                        city: ''
                    }));
                }
            }

            generateCaptcha();
            render();
        }

        // Start the application
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>